<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.17">
  <compounddef id="sd__states_8py" kind="file" language="Python">
    <compoundname>sd_states.py</compoundname>
    <innerclass refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability" prot="public">challenge_serving_drinks::sd_states::AskAvailability</innerclass>
    <innerclass refid="classchallenge__serving__drinks_1_1sd__states_1_1AskDrink" prot="public">challenge_serving_drinks::sd_states::AskDrink</innerclass>
    <innerclass refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability" prot="public">challenge_serving_drinks::sd_states::CheckAvailability</innerclass>
    <innerclass refid="classchallenge__serving__drinks_1_1sd__states_1_1DescriptionStrDesignator" prot="public">challenge_serving_drinks::sd_states::DescriptionStrDesignator</innerclass>
    <innernamespace refid="namespacechallenge__serving__drinks_1_1sd__states">challenge_serving_drinks::sd_states</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1" refid="namespacechallenge__serving__drinks_1_1sd__states" refkind="compound"><highlight class="comment">#<sp/>System</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>random</highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="comment">#<sp/>ROS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>rospy</highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>smach</highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="comment">#<sp/>TU/e<sp/>Robotics</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>robot_smach_states<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>states</highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>robot_smach_states.util.designators<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>ds</highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>hmi<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>TimeoutException</highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight></codeline>
<codeline lineno="15" refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability" kindref="compound">CheckAvailability</ref>(smach.State):</highlight></codeline>
<codeline lineno="16"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="17"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Hears<sp/>the<sp/>desired<sp/>drink<sp/>and<sp/>checks<sp/>its<sp/>availability.</highlight></codeline>
<codeline lineno="18"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight></codeline>
<codeline lineno="20" refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1a436d06ac286a3a3208a41918a3154101" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1a436d06ac286a3a3208a41918a3154101" kindref="member">__init__</ref>(self,<sp/>robot,<sp/>drink_designator,<sp/>available_drinks_designator,<sp/>unavailable_drink_designator,</highlight></codeline>
<codeline lineno="21"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>objects,<sp/>max_tries=6,<sp/>max_queries_per_try=3):</highlight></codeline>
<codeline lineno="22"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>type<sp/>(Robot,<sp/>VariableDesignator)<sp/>-&gt;<sp/>None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="24"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Initialization<sp/>method</highlight></codeline>
<codeline lineno="25"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="26"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>robot:<sp/>robot<sp/>api<sp/>object</highlight></codeline>
<codeline lineno="27"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>drink_designator:<sp/>(VariableDesignator)<sp/>in<sp/>which<sp/>the<sp/>drink<sp/>to<sp/>fetch<sp/>is<sp/>stored</highlight></codeline>
<codeline lineno="28"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>available_drinks_designator:<sp/>(VariableDesignator)<sp/>in<sp/>which<sp/>the<sp/>available<sp/>drinks<sp/>are<sp/>stored</highlight></codeline>
<codeline lineno="29"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>unavailable_drink_designator:<sp/>(VariableDesignator)<sp/>in<sp/>which<sp/>the<sp/>unavailable<sp/>drink<sp/>is<sp/>stored</highlight></codeline>
<codeline lineno="30"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>objects:<sp/>Objects<sp/>from<sp/>common<sp/>knowledge</highlight></codeline>
<codeline lineno="31"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>max_tries:<sp/>(int)<sp/>maximum<sp/>number<sp/>of<sp/>times<sp/>the<sp/>robot<sp/>asks<sp/>which<sp/>drink</highlight></codeline>
<codeline lineno="32"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>max_queries_per_try:<sp/>(int)<sp/>maximum<sp/>number<sp/>of<sp/>queries<sp/>to<sp/>the<sp/>HMI<sp/>server<sp/>per<sp/>try</highlight></codeline>
<codeline lineno="33"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34" refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1a5c4518d0d51d1f0e9dfd413a3691420f" refkind="member"><highlight class="normal"></highlight></codeline>
<codeline lineno="35" refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1ae3f49342d830fde16d2eeea279b1a47b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1a5c4518d0d51d1f0e9dfd413a3691420f" kindref="member">_robot</ref><sp/>=<sp/>robot</highlight></codeline>
<codeline lineno="36" refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1abcd1c69be887e04210aa5cb25276dbd6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1ae3f49342d830fde16d2eeea279b1a47b" kindref="member">_drink_designator</ref><sp/>=<sp/>drink_designator</highlight></codeline>
<codeline lineno="37" refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1a07682a15fe18c1909f7a369f2ae1aeeb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1abcd1c69be887e04210aa5cb25276dbd6" kindref="member">_available_drinks_designator</ref><sp/>=<sp/>available_drinks_designator</highlight></codeline>
<codeline lineno="38" refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1a51d0da906f8de4f65c9a9c93e2497ff1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1a07682a15fe18c1909f7a369f2ae1aeeb" kindref="member">_unavailable_drink_designator</ref><sp/>=<sp/>unavailable_drink_designator</highlight></codeline>
<codeline lineno="39" refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1add6dbc9cf7704c7433b5538c62b4daf4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1a51d0da906f8de4f65c9a9c93e2497ff1" kindref="member">_objects</ref><sp/>=<sp/>objects</highlight></codeline>
<codeline lineno="40" refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1af0643f6424e57dbc63241c4034f646e8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1add6dbc9cf7704c7433b5538c62b4daf4" kindref="member">_max_tries</ref><sp/>=<sp/>max_tries</highlight></codeline>
<codeline lineno="41" refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1a2a7358e4a606f7f126e395032d26b19a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1af0643f6424e57dbc63241c4034f646e8" kindref="member">_max_queries_per_try</ref><sp/>=<sp/>max_queries_per_try</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1a2a7358e4a606f7f126e395032d26b19a" kindref="member">trial</ref><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight></codeline>
<codeline lineno="44" refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1ab6d2990307681174fc1140177fb58b0c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Speech<sp/>grammars</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._drinks_grammar,<sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1ab6d2990307681174fc1140177fb58b0c" kindref="member">_drinks_target</ref><sp/>=<sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1a2f0e760c9492cfe20c3dcdaf508c4cfa" kindref="member">_setup_drinks_grammar</ref>()</highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>smach.State.__init__(self,<sp/>outcomes=[</highlight><highlight class="stringliteral">&quot;available&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;unavailable&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;aborted&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;bad_operator&quot;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight></codeline>
<codeline lineno="49" refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1a2f0e760c9492cfe20c3dcdaf508c4cfa" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1a2f0e760c9492cfe20c3dcdaf508c4cfa" kindref="member">_setup_drinks_grammar</ref>(self):</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="51"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Sets<sp/>up<sp/>the<sp/>grammar<sp/>to<sp/>ask<sp/>which<sp/>drink<sp/>someone<sp/>would<sp/>like<sp/>based<sp/>on<sp/>the<sp/>objects<sp/>in<sp/>the<sp/>knowlegde.</highlight></codeline>
<codeline lineno="52"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:return:<sp/>tuple(str,<sp/>str)<sp/>grammar<sp/>and<sp/>target</highlight></codeline>
<codeline lineno="53"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Setup<sp/>base</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grammar<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;O[P]<sp/>-&gt;<sp/>BEVERAGE[P]<sp/>|<sp/>can<sp/>i<sp/>have<sp/>a<sp/>BEVERAGE[P]<sp/>|<sp/>i<sp/>would<sp/>like<sp/>BEVERAGE[P]<sp/>|<sp/>can<sp/>i<sp/>get<sp/>BEVERAGE[P]&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grammar<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;<sp/>|<sp/>could<sp/>i<sp/>have<sp/>BEVERAGE[P]<sp/>|<sp/>may<sp/>i<sp/>get<sp/>BEVERAGE[P]<sp/>|<sp/>bring<sp/>me<sp/>BEVERAGE[P]&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grammar<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;\nBEVERAGE[B]<sp/>-&gt;<sp/>BEV[B]<sp/>|<sp/>DET<sp/>BEV[B]&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grammar<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;\nDET<sp/>-&gt;<sp/>a<sp/>|<sp/>an&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Add<sp/>drinks</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>d<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1a51d0da906f8de4f65c9a9c93e2497ff1" kindref="member">_objects</ref>:</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>d[</highlight><highlight class="stringliteral">&quot;category&quot;</highlight><highlight class="normal">]<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;drink&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grammar<sp/>+=<sp/></highlight><highlight class="stringliteral">&quot;\nBEV[&apos;{}&apos;]<sp/>-&gt;<sp/>{}[B]&quot;</highlight><highlight class="normal">.format(d[</highlight><highlight class="stringliteral">&quot;name&quot;</highlight><highlight class="normal">],<sp/>d[</highlight><highlight class="stringliteral">&quot;name&quot;</highlight><highlight class="normal">].replace(</highlight><highlight class="stringliteral">&apos;_&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>grammar,<sp/></highlight><highlight class="stringliteral">&quot;O&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight></codeline>
<codeline lineno="67" refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1ae1f2a6ae83557c7fab6c54df2adb75ca" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1ae1f2a6ae83557c7fab6c54df2adb75ca" kindref="member">execute</ref>(self,<sp/>userdata=None):</highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1a2a7358e4a606f7f126e395032d26b19a" kindref="member">trial</ref><sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1a2a7358e4a606f7f126e395032d26b19a" kindref="member">trial</ref><sp/>&lt;<sp/>(self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1add6dbc9cf7704c7433b5538c62b4daf4" kindref="member">_max_tries</ref><sp/>+<sp/>1)<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>rospy.is_shutdown():</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rospy.loginfo(</highlight><highlight class="stringliteral">&quot;AskDrink:<sp/>attempt<sp/>{}<sp/>of<sp/>{}&quot;</highlight><highlight class="normal">.format(self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1a2a7358e4a606f7f126e395032d26b19a" kindref="member">trial</ref>,<sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1add6dbc9cf7704c7433b5538c62b4daf4" kindref="member">_max_tries</ref>))</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rospy.loginfo(</highlight><highlight class="stringliteral">&quot;Unavailable<sp/>drink:<sp/>{}&quot;</highlight><highlight class="normal">.format(self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1a07682a15fe18c1909f7a369f2ae1aeeb" kindref="member">_unavailable_drink_designator</ref>.resolve()))</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rospy.loginfo(</highlight><highlight class="stringliteral">&quot;Available<sp/>drinks:<sp/>{}&quot;</highlight><highlight class="normal">.format(self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1abcd1c69be887e04210aa5cb25276dbd6" kindref="member">_available_drinks_designator</ref>.resolve()))</highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Try<sp/>to<sp/>get<sp/>the<sp/>answer</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>speech_result<sp/>=<sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1aeda658f3c60fecc09cdf1cad90ee41be" kindref="member">_query_drink</ref>(self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1af0643f6424e57dbc63241c4034f646e8" kindref="member">_max_queries_per_try</ref>)</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>TimeoutException:</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;aborted&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"></highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>ToDo:<sp/>Check<sp/>if<sp/>the<sp/>drink<sp/>is<sp/>in<sp/>the<sp/>list<sp/>of<sp/>available<sp/>drinks</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Check<sp/>if<sp/>the<sp/>drink<sp/>is<sp/>unavailable</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>if<sp/>speech_result.semantics<sp/>in<sp/>self._available_drinks_designator.resolve():</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>#<sp/>Store<sp/>the<sp/>requested<sp/>drink<sp/>in<sp/>the<sp/>designator</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>self._drink_designator.write(str(speech_result.semantics))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>rospy.loginfo(&quot;Requested<sp/>drink:<sp/>{}&quot;.format(self._drink_designator.resolve()))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>return<sp/>&quot;available&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="88"><highlight class="normal"></highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>speech_result.semantics<sp/>==<sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1a07682a15fe18c1909f7a369f2ae1aeeb" kindref="member">_unavailable_drink_designator</ref>.resolve():</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;unavailable&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Store<sp/>the<sp/>requested<sp/>drink<sp/>in<sp/>the<sp/>designator</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1ae3f49342d830fde16d2eeea279b1a47b" kindref="member">_drink_designator</ref>.write(str(speech_result.semantics))</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rospy.loginfo(</highlight><highlight class="stringliteral">&quot;Requested<sp/>drink:<sp/>{}&quot;</highlight><highlight class="normal">.format(self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1ae3f49342d830fde16d2eeea279b1a47b" kindref="member">_drink_designator</ref>.resolve()))</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;available&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;bad_operator&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal"></highlight></codeline>
<codeline lineno="99" refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1aeda658f3c60fecc09cdf1cad90ee41be" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1aeda658f3c60fecc09cdf1cad90ee41be" kindref="member">_query_drink</ref>(self,<sp/>max_tries):</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="101"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Queries<sp/>the<sp/>HMI<sp/>server<sp/>for<sp/>&lt;max_tries&gt;<sp/>times<sp/>until<sp/>a<sp/>result<sp/>has<sp/>been<sp/>obtained</highlight></codeline>
<codeline lineno="102"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:return:<sp/>(HMIResult)<sp/>(N.B.:<sp/>the<sp/>&apos;semantics&apos;<sp/>attribute<sp/>should<sp/>be<sp/>a<sp/>dict<sp/>with<sp/>&apos;beverage&apos;<sp/>key)</highlight></codeline>
<codeline lineno="103"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:raises:<sp/>(TimeoutException)<sp/>if<sp/>robot<sp/>didn&apos;t<sp/>hear<sp/>anything</highlight></codeline>
<codeline lineno="104"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attempt<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>rospy.is_shutdown():</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attempt<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>speech_result<sp/>=<sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1a5c4518d0d51d1f0e9dfd413a3691420f" kindref="member">_robot</ref>.hmi.query(description=</highlight><highlight class="stringliteral">&quot;Can<sp/>I<sp/>please<sp/>take<sp/>your<sp/>order&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grammar=self._drinks_grammar,</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target=self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1ab6d2990307681174fc1140177fb58b0c" kindref="member">_drinks_target</ref>)</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>speech_result</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>TimeoutException:</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>attempt<sp/>&gt;=<sp/>max_tries:</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">#<sp/>Re-raise</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="116"><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>We<sp/>only<sp/>end<sp/>up<sp/>here<sp/>if<sp/>the<sp/>exception<sp/>was<sp/>caught</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability_1a5c4518d0d51d1f0e9dfd413a3691420f" kindref="member">_robot</ref>.speech.speak(random.choice([</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;I&apos;m<sp/>sorry,<sp/>can<sp/>you<sp/>repeat&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Please<sp/>repeat<sp/>your<sp/>order,<sp/>I<sp/>didn&apos;t<sp/>hear<sp/>you&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;I<sp/>didn&apos;t<sp/>get<sp/>your<sp/>order,<sp/>can<sp/>you<sp/>repeat<sp/>it&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Please<sp/>speak<sp/>up,<sp/>as<sp/>I<sp/>didn&apos;t<sp/>hear<sp/>your<sp/>order&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>]))</highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"></highlight></codeline>
<codeline lineno="126" refid="classchallenge__serving__drinks_1_1sd__states_1_1AskDrink" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskDrink" kindref="compound">AskDrink</ref>(smach.StateMachine):</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="128"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Asks<sp/>the<sp/>operator<sp/>what<sp/>he/she<sp/>would<sp/>like<sp/>to<sp/>drink.</highlight></codeline>
<codeline lineno="129"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="130" refid="classchallenge__serving__drinks_1_1sd__states_1_1AskDrink_1abdc48e31921e7016bfaab8ba4b0bda37" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskDrink_1abdc48e31921e7016bfaab8ba4b0bda37" kindref="member">__init__</ref>(self,<sp/>robot,<sp/>operator_name,<sp/>drink_designator,<sp/>available_drinks_designator,</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unavailable_drink_designator,<sp/>objects):</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>type<sp/>(Robot,<sp/>VariableDesignator)<sp/>-&gt;<sp/>None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="134"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Initialization<sp/>method</highlight></codeline>
<codeline lineno="135"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="136"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>robot:<sp/>robot<sp/>api<sp/>object</highlight></codeline>
<codeline lineno="137"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>operator_name:<sp/>(EntityDesignator)<sp/>in<sp/>which<sp/>the<sp/>operator&apos;s<sp/>name<sp/>is<sp/>stored</highlight></codeline>
<codeline lineno="138"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>drink_designator:<sp/>(VariableDesignator)<sp/>in<sp/>which<sp/>the<sp/>drink<sp/>to<sp/>fetch<sp/>is<sp/>stored</highlight></codeline>
<codeline lineno="139"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>available_drinks_designator:<sp/>(VariableDesignator)<sp/>in<sp/>which<sp/>the<sp/>available<sp/>drinks<sp/>are<sp/>stored</highlight></codeline>
<codeline lineno="140"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>unavailable_drink_designator:<sp/>(VariableDesignator)<sp/>in<sp/>which<sp/>the<sp/>unavailable<sp/>drink<sp/>is<sp/>stored</highlight></codeline>
<codeline lineno="141"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>objects:<sp/>Objects<sp/>from<sp/>common<sp/>knowledge</highlight></codeline>
<codeline lineno="142"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal"></highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>smach.StateMachine.__init__(self,<sp/>outcomes=[</highlight><highlight class="stringliteral">&quot;succeeded&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;failed&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;aborted&quot;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="145"><highlight class="normal"></highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">with</highlight><highlight class="normal"><sp/>self:</highlight></codeline>
<codeline lineno="147"><highlight class="normal"></highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Ask<sp/>for<sp/>order</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>smach.StateMachine.add(</highlight><highlight class="stringliteral">&quot;RISE_FOR_HMI&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>states.RiseForHMI(robot=robot),</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>transitions={</highlight><highlight class="stringliteral">&quot;succeeded&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;ASK_FOR_ORDER&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;failed&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;ASK_FOR_ORDER&quot;</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="153"><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>smach.StateMachine.add(</highlight><highlight class="stringliteral">&quot;ASK_FOR_ORDER&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>states.Say(robot=robot,</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sentence=random.choice([</highlight><highlight class="stringliteral">&quot;What<sp/>would<sp/>you<sp/>like<sp/>to<sp/>drink?&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Which<sp/>drink<sp/>would<sp/>you<sp/>like?&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;What<sp/>would<sp/>you<sp/>like<sp/>to<sp/>quench<sp/>your<sp/>thirst?&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;What<sp/>can<sp/>I<sp/>get<sp/>you?&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Please<sp/>tell<sp/>me<sp/>which<sp/>drink<sp/>you<sp/>want&quot;</highlight><highlight class="normal">]),</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>look_at_standing_person=</highlight><highlight class="keyword">True</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>transitions={</highlight><highlight class="stringliteral">&quot;spoken&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;CHECK_AVAILABILITY&quot;</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="163"><highlight class="normal"></highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Check<sp/>availability</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>smach.StateMachine.add(</highlight><highlight class="stringliteral">&quot;CHECK_AVAILABILITY&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classchallenge__serving__drinks_1_1sd__states_1_1CheckAvailability" kindref="compound">CheckAvailability</ref>(robot=robot,<sp/>drink_designator=drink_designator,</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>available_drinks_designator=available_drinks_designator,</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unavailable_drink_designator=unavailable_drink_designator,</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>objects=objects),</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>transitions={</highlight><highlight class="stringliteral">&quot;available&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;ASK_FOR_CONFIRMATION&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;unavailable&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;STATE_UNAVAILABLE&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;aborted&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;aborted&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;bad_operator&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;SAY_BAD_OPERATOR&quot;</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="174"><highlight class="normal"></highlight></codeline>
<codeline lineno="175"><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Ask<sp/>for<sp/>confirmation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>smach.StateMachine.add(</highlight><highlight class="stringliteral">&quot;ASK_FOR_CONFIRMATION&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>states.Say(robot=robot,</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sentence=<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1DescriptionStrDesignator" kindref="compound">DescriptionStrDesignator</ref>(</highlight><highlight class="stringliteral">&quot;confirmation_available&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>drink_designator,<sp/>operator_name),</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>look_at_standing_person=</highlight><highlight class="keyword">True</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>transitions={</highlight><highlight class="stringliteral">&quot;spoken&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;HEAR_CONFIRMATION&quot;</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="183"><highlight class="normal"></highlight></codeline>
<codeline lineno="184"><highlight class="normal"></highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Hear<sp/>the<sp/>confirmation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>smach.StateMachine.add(</highlight><highlight class="stringliteral">&quot;HEAR_CONFIRMATION&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>states.HearOptions(robot=robot,<sp/>options=[</highlight><highlight class="stringliteral">&quot;yes&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;no&quot;</highlight><highlight class="normal">]),</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>transitions={</highlight><highlight class="stringliteral">&quot;yes&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;succeeded&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;no&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;ASK_FOR_ORDER&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;no_result&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;ASK_FOR_ORDER&quot;</highlight><highlight class="normal">})<sp/><sp/></highlight><highlight class="comment">#<sp/>ToDo:<sp/>fallback?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Announce<sp/>that<sp/>the<sp/>drink<sp/>is<sp/>unavailable</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>smach.StateMachine.add(</highlight><highlight class="stringliteral">&quot;STATE_UNAVAILABLE&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>states.Say(robot=robot,</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sentence=<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1DescriptionStrDesignator" kindref="compound">DescriptionStrDesignator</ref>(</highlight><highlight class="stringliteral">&quot;state_unavailable&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unavailable_drink_designator,</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operator_name),</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>look_at_standing_person=</highlight><highlight class="keyword">True</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>transitions={</highlight><highlight class="stringliteral">&quot;spoken&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;ASK_FOR_ORDER&quot;</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Tell<sp/>the<sp/>operator<sp/>to<sp/>stop<sp/>fucking<sp/>around!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>smach.StateMachine.add(</highlight><highlight class="stringliteral">&quot;SAY_BAD_OPERATOR&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>states.Say(robot=robot,</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sentence=</highlight><highlight class="stringliteral">&quot;I&apos;m<sp/>not<sp/>going<sp/>to<sp/>ask<sp/>you<sp/>again<sp/>as<sp/>I<sp/>have<sp/>already<sp/>informed<sp/>you<sp/>multiple<sp/>times<sp/>that<sp/>your<sp/>request<sp/>is<sp/>unavailable&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>look_at_standing_person=</highlight><highlight class="keyword">True</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>transitions={</highlight><highlight class="stringliteral">&quot;spoken&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;aborted&quot;</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="207"><highlight class="normal"></highlight></codeline>
<codeline lineno="208"><highlight class="normal"></highlight></codeline>
<codeline lineno="209" refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability" kindref="compound">AskAvailability</ref>(smach.State):</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>Asks<sp/>the<sp/>bartender<sp/>which<sp/>is<sp/>the<sp/>unavailable<sp/>drink.</highlight></codeline>
<codeline lineno="211"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="212"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>This<sp/>is<sp/>based<sp/>on<sp/>the<sp/>&apos;TakeOrder&apos;<sp/>class<sp/>of<sp/>the<sp/>the<sp/>restaurant<sp/>challenge.<sp/>Might</highlight></codeline>
<codeline lineno="213"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>be<sp/>nice<sp/>to<sp/>merge<sp/>these<sp/>two.</highlight></codeline>
<codeline lineno="214"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="215" refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1ad0a535571c90d421046f2e081cde516b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1ad0a535571c90d421046f2e081cde516b" kindref="member">__init__</ref>(self,<sp/>robot,<sp/>unavailable_drink_designator,<sp/>objects,<sp/>max_tries=3,<sp/>max_queries_per_try=3):</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>type<sp/>(Robot,<sp/>VariableDesignator)<sp/>-&gt;<sp/>None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>Initialization<sp/>method</highlight></codeline>
<codeline lineno="218"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="219"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>robot:<sp/>robot<sp/>api<sp/>object</highlight></codeline>
<codeline lineno="220"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>unavailable_drink_designator:<sp/>(VariableDesignator)<sp/>in<sp/>which<sp/>the<sp/>unavailable<sp/>drink<sp/>is<sp/>stored</highlight></codeline>
<codeline lineno="221"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>objects:<sp/>Objects<sp/>from<sp/>common<sp/>knowledge</highlight></codeline>
<codeline lineno="222"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>max_tries:<sp/>(int)<sp/>maximum<sp/>number<sp/>of<sp/>times<sp/>the<sp/>robot<sp/>asks<sp/>which<sp/>drink</highlight></codeline>
<codeline lineno="223"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>max_queries_per_try:<sp/>(int)<sp/>maximum<sp/>number<sp/>of<sp/>queries<sp/>to<sp/>the<sp/>HMI<sp/>server<sp/>per<sp/>try</highlight></codeline>
<codeline lineno="224"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>smach.State.__init__(self,<sp/>outcomes=[</highlight><highlight class="stringliteral">&quot;succeeded&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;failed&quot;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="226" refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1adaaa08cd6e2d48a82caedf4145cca993" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1adaaa08cd6e2d48a82caedf4145cca993" kindref="member">_robot</ref><sp/>=<sp/>robot</highlight></codeline>
<codeline lineno="227" refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1acb070bb46838a505da8b60c4b9ee3d47" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1acb070bb46838a505da8b60c4b9ee3d47" kindref="member">_unavailable_drink_designator</ref><sp/>=<sp/>unavailable_drink_designator</highlight></codeline>
<codeline lineno="228" refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1a0b60c4d45d7ab1454729a8bd818e1602" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1a0b60c4d45d7ab1454729a8bd818e1602" kindref="member">_objects</ref><sp/>=<sp/>objects</highlight></codeline>
<codeline lineno="229" refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1a7be30f43ededf1f41a2ca2383c4e9ab0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1a7be30f43ededf1f41a2ca2383c4e9ab0" kindref="member">_max_tries</ref><sp/>=<sp/>max_tries</highlight></codeline>
<codeline lineno="230" refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1a2265f2d78c0f25724d48539d4e4a964c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1a2265f2d78c0f25724d48539d4e4a964c" kindref="member">_max_queries_per_try</ref><sp/>=<sp/>max_queries_per_try</highlight></codeline>
<codeline lineno="231" refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1aae0a8f0e51f48c53a37cca58bf0578d5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1aae0a8f0e51f48c53a37cca58bf0578d5" kindref="member">_trial</ref><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="232"><highlight class="normal"></highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Speech<sp/>grammars</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="234" refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1a6e0d0cfb70046367e96895d4a5a1fd95" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._drinks_grammar,<sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1a6e0d0cfb70046367e96895d4a5a1fd95" kindref="member">_drinks_target</ref><sp/>=<sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1a55aff0b527c96d986eb4467af1ef9724" kindref="member">_setup_drinks_grammar</ref>()</highlight></codeline>
<codeline lineno="235"><highlight class="normal"></highlight></codeline>
<codeline lineno="236" refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1a55aff0b527c96d986eb4467af1ef9724" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1a55aff0b527c96d986eb4467af1ef9724" kindref="member">_setup_drinks_grammar</ref>(self):</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>Sets<sp/>up<sp/>the<sp/>grammar<sp/>to<sp/>ask<sp/>which<sp/>drink<sp/>is<sp/>unavailable<sp/>based<sp/>on<sp/>the<sp/>objects<sp/>in<sp/>the<sp/>knowlegde.</highlight></codeline>
<codeline lineno="238"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="239"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:return:<sp/>tuple(str,<sp/>str)<sp/>grammar<sp/>and<sp/>target</highlight></codeline>
<codeline lineno="240"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="241"><highlight class="normal"></highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Setup<sp/>base</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grammar<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;O[P]<sp/>-&gt;<sp/>BEVERAGE[P]<sp/>|<sp/>DET<sp/>unavailable<sp/>drink<sp/>is<sp/>BEVERAGE[P]<sp/>|<sp/>BEVERAGE[P]<sp/>is<sp/>unavailable&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grammar<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;\nBEVERAGE[B]<sp/>-&gt;<sp/>BEV[B]<sp/>|<sp/>DET<sp/>BEV[B]&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grammar<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;\nDET<sp/>-&gt;<sp/>a<sp/>|<sp/>an<sp/>|<sp/>the&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="246"><highlight class="normal"></highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Add<sp/>drinks</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>d<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1a0b60c4d45d7ab1454729a8bd818e1602" kindref="member">_objects</ref>:</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>d[</highlight><highlight class="stringliteral">&quot;category&quot;</highlight><highlight class="normal">]<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;drink&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grammar<sp/>+=<sp/></highlight><highlight class="stringliteral">&quot;\nBEV[&apos;{}&apos;]<sp/>-&gt;<sp/>{}[B]&quot;</highlight><highlight class="normal">.format(d[</highlight><highlight class="stringliteral">&quot;name&quot;</highlight><highlight class="normal">],<sp/>d[</highlight><highlight class="stringliteral">&quot;name&quot;</highlight><highlight class="normal">].replace(</highlight><highlight class="stringliteral">&apos;_&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>grammar,<sp/></highlight><highlight class="stringliteral">&quot;O&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="252"><highlight class="normal"></highlight></codeline>
<codeline lineno="253" refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1a2bd27f613153b87bc7f8426387f37af9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1a2bd27f613153b87bc7f8426387f37af9" kindref="member">execute</ref>(self,<sp/>userdata=None):</highlight></codeline>
<codeline lineno="254"><highlight class="normal"></highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1adaaa08cd6e2d48a82caedf4145cca993" kindref="member">_robot</ref>.head.look_at_standing_person()</highlight></codeline>
<codeline lineno="256"><highlight class="normal"></highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1aae0a8f0e51f48c53a37cca58bf0578d5" kindref="member">_trial</ref><sp/>&lt;<sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1a7be30f43ededf1f41a2ca2383c4e9ab0" kindref="member">_max_tries</ref><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>rospy.is_shutdown():</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1aae0a8f0e51f48c53a37cca58bf0578d5" kindref="member">_trial</ref><sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rospy.loginfo(</highlight><highlight class="stringliteral">&quot;AskAvailable:<sp/>attempt<sp/>{}<sp/>of<sp/>{}&quot;</highlight><highlight class="normal">.format(self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1aae0a8f0e51f48c53a37cca58bf0578d5" kindref="member">_trial</ref>,<sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1a7be30f43ededf1f41a2ca2383c4e9ab0" kindref="member">_max_tries</ref>))</highlight></codeline>
<codeline lineno="260"><highlight class="normal"></highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Ask<sp/>the<sp/>bartender<sp/>a<sp/>question</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1adaaa08cd6e2d48a82caedf4145cca993" kindref="member">_robot</ref>.speech.speak(</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>random.choice([</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;I<sp/>am<sp/>unable<sp/>to<sp/>inspect<sp/>the<sp/>bar.<sp/>Would<sp/>you<sp/>tell<sp/>me<sp/>which<sp/>is<sp/>the<sp/>unavailable<sp/>drink?&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Would<sp/>you<sp/>tell<sp/>me<sp/>which<sp/>is<sp/>the<sp/>unavailable<sp/>drink?&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Please<sp/>tell<sp/>me<sp/>which<sp/>drink<sp/>is<sp/>unavailable&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>]),</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block=</highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="270"><highlight class="normal"></highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Try<sp/>to<sp/>get<sp/>the<sp/>answer</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>speech_result<sp/>=<sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1a852fd86ba8fdaaf27418abd297c97e8a" kindref="member">_query_drink</ref>(self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1a2265f2d78c0f25724d48539d4e4a964c" kindref="member">_max_queries_per_try</ref>)</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>TimeoutException:</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="276"><highlight class="normal"></highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Ask<sp/>for<sp/>confirmation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1adaaa08cd6e2d48a82caedf4145cca993" kindref="member">_robot</ref>.speech.speak(</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;I<sp/>understood<sp/>that<sp/>the<sp/>{}<sp/>is<sp/>unavailable,<sp/>is<sp/>that<sp/>correct?&quot;</highlight><highlight class="normal">.format(speech_result.semantics)</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1afe01f758cd36f1b97756f2a51b9cdfda" kindref="member">_confirm</ref>():</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="283"><highlight class="normal"></highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Store<sp/>the<sp/>type<sp/>in<sp/>the<sp/>designator</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1acb070bb46838a505da8b60c4b9ee3d47" kindref="member">_unavailable_drink_designator</ref>.write(str(speech_result.semantics))</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rospy.loginfo(</highlight><highlight class="stringliteral">&quot;Unavailable<sp/>drink:<sp/>{}&quot;</highlight><highlight class="normal">.format(self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1acb070bb46838a505da8b60c4b9ee3d47" kindref="member">_unavailable_drink_designator</ref>.resolve()))</highlight></codeline>
<codeline lineno="287"><highlight class="normal"></highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;succeeded&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="289"><highlight class="normal"></highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1adaaa08cd6e2d48a82caedf4145cca993" kindref="member">_robot</ref>.speech.speak(</highlight><highlight class="stringliteral">&quot;I<sp/>am<sp/>sorry<sp/>but<sp/>I<sp/>cannot<sp/>understand<sp/>you.<sp/>I<sp/>will<sp/>continue<sp/>with<sp/>my<sp/>tasks&quot;</highlight><highlight class="normal">,<sp/>block=</highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1adaaa08cd6e2d48a82caedf4145cca993" kindref="member">_robot</ref>.head.cancel_goal()</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rospy.loginfo(</highlight><highlight class="stringliteral">&quot;Unavailable<sp/>drink<sp/>still<sp/>unknown&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;failed&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="294"><highlight class="normal"></highlight></codeline>
<codeline lineno="295" refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1a852fd86ba8fdaaf27418abd297c97e8a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1a852fd86ba8fdaaf27418abd297c97e8a" kindref="member">_query_drink</ref>(self,<sp/>max_tries):</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="297"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Queries<sp/>the<sp/>HMI<sp/>server<sp/>for<sp/>&lt;max_tries&gt;<sp/>times<sp/>until<sp/>a<sp/>result<sp/>has<sp/>been<sp/>obtained</highlight></codeline>
<codeline lineno="298"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:return:<sp/>(HMIResult)<sp/>(N.B.:<sp/>the<sp/>&apos;semantics&apos;<sp/>attribute<sp/>should<sp/>be<sp/>a<sp/>dict<sp/>with<sp/>&apos;beverage&apos;<sp/>key)</highlight></codeline>
<codeline lineno="299"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:raises:<sp/>(TimeoutException)<sp/>if<sp/>robot<sp/>didn&apos;t<sp/>hear<sp/>anything</highlight></codeline>
<codeline lineno="300"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attempt<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>rospy.is_shutdown():</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attempt<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>speech_result<sp/>=<sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1adaaa08cd6e2d48a82caedf4145cca993" kindref="member">_robot</ref>.hmi.query(description=</highlight><highlight class="stringliteral">&quot;Which<sp/>is<sp/>the<sp/>unavailable<sp/>beverage?&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grammar=self._drinks_grammar,</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target=self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1a6e0d0cfb70046367e96895d4a5a1fd95" kindref="member">_drinks_target</ref>)</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>speech_result</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>TimeoutException:</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>attempt<sp/>&gt;=<sp/>max_tries:</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">#<sp/>Re-raise</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="312"><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>We<sp/>only<sp/>end<sp/>up<sp/>here<sp/>if<sp/>the<sp/>exception<sp/>was<sp/>caught</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1adaaa08cd6e2d48a82caedf4145cca993" kindref="member">_robot</ref>.speech.speak(random.choice([</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;I&apos;m<sp/>sorry,<sp/>can<sp/>you<sp/>repeat&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Please<sp/>repeat<sp/>the<sp/>drink,<sp/>I<sp/>didn&apos;t<sp/>hear<sp/>you&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;I<sp/>didn&apos;t<sp/>get<sp/>the<sp/>drink,<sp/>can<sp/>you<sp/>repeat<sp/>it&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Please<sp/>speak<sp/>up,<sp/>as<sp/>I<sp/>didn&apos;t<sp/>hear<sp/>what<sp/>you<sp/>just<sp/>said&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>]))</highlight></codeline>
<codeline lineno="320"><highlight class="normal"></highlight></codeline>
<codeline lineno="321" refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1afe01f758cd36f1b97756f2a51b9cdfda" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1afe01f758cd36f1b97756f2a51b9cdfda" kindref="member">_confirm</ref>(self):</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="323"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Queries<sp/>the<sp/>HMI<sp/>server<sp/>for<sp/>confirmation</highlight></codeline>
<codeline lineno="324"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:return:<sp/>(bool)<sp/>whether<sp/>the<sp/>understood<sp/>beverage<sp/>was<sp/>correct</highlight></codeline>
<codeline lineno="325"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>speech_result<sp/>=<sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskAvailability_1adaaa08cd6e2d48a82caedf4145cca993" kindref="member">_robot</ref>.hmi.query(description=</highlight><highlight class="stringliteral">&quot;Is<sp/>this<sp/>correct?&quot;</highlight><highlight class="normal">,<sp/>grammar=</highlight><highlight class="stringliteral">&quot;T[True]<sp/>-&gt;<sp/>yes;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;T[False]<sp/>-&gt;<sp/>no&quot;</highlight><highlight class="normal">,<sp/>target=</highlight><highlight class="stringliteral">&quot;T&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>TimeoutException:</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="331"><highlight class="normal"></highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>speech_result.semantics</highlight></codeline>
<codeline lineno="333"><highlight class="normal"></highlight></codeline>
<codeline lineno="334"><highlight class="normal"></highlight></codeline>
<codeline lineno="335" refid="classchallenge__serving__drinks_1_1sd__states_1_1DescriptionStrDesignator" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classchallenge__serving__drinks_1_1sd__states_1_1DescriptionStrDesignator" kindref="compound">DescriptionStrDesignator</ref>(ds.Designator):</highlight></codeline>
<codeline lineno="336" refid="classchallenge__serving__drinks_1_1sd__states_1_1DescriptionStrDesignator_1a851be258f19c633cc14a16fbd42791d0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classchallenge__serving__drinks_1_1sd__states_1_1DescriptionStrDesignator_1a851be258f19c633cc14a16fbd42791d0" kindref="member">__init__</ref>(self,<sp/>message_type,<sp/>drink_request_des,<sp/>operator_name_des,<sp/>name=None):</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>super(DescriptionStrDesignator,<sp/>self).<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1DescriptionStrDesignator_1a851be258f19c633cc14a16fbd42791d0" kindref="member">__init__</ref>(resolve_type=str,<sp/>name=name)</highlight></codeline>
<codeline lineno="338"><highlight class="normal"></highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ds.check_type(operator_name_des,<sp/>str)</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ds.check_type(drink_request_des,<sp/>str)</highlight></codeline>
<codeline lineno="341"><highlight class="normal"></highlight></codeline>
<codeline lineno="342" refid="classchallenge__serving__drinks_1_1sd__states_1_1DescriptionStrDesignator_1ae4a1e24327538d4a60d0f2c72f7583a4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1DescriptionStrDesignator_1ae4a1e24327538d4a60d0f2c72f7583a4" kindref="member">message_type</ref><sp/>=<sp/>message_type</highlight></codeline>
<codeline lineno="343" refid="classchallenge__serving__drinks_1_1sd__states_1_1DescriptionStrDesignator_1a2951bce50cc278e8e83d73d3e170df67" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1DescriptionStrDesignator_1a2951bce50cc278e8e83d73d3e170df67" kindref="member">operator_name_des</ref><sp/>=<sp/>operator_name_des</highlight></codeline>
<codeline lineno="344" refid="classchallenge__serving__drinks_1_1sd__states_1_1DescriptionStrDesignator_1a7ce2ca49dad6abee2022312f3677cbbc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1DescriptionStrDesignator_1a7ce2ca49dad6abee2022312f3677cbbc" kindref="member">drink_request_des</ref><sp/>=<sp/>drink_request_des</highlight></codeline>
<codeline lineno="345"><highlight class="normal"></highlight></codeline>
<codeline lineno="346" refid="classchallenge__serving__drinks_1_1sd__states_1_1DescriptionStrDesignator_1a4959088e1327e815e6c43ab091383824" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classchallenge__serving__drinks_1_1sd__states_1_1DescriptionStrDesignator_1a4959088e1327e815e6c43ab091383824" kindref="member">_resolve</ref>(self):</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operator_name<sp/>=<sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1DescriptionStrDesignator_1a2951bce50cc278e8e83d73d3e170df67" kindref="member">operator_name_des</ref>.resolve()</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>operator_name:</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rospy.logerr(</highlight><highlight class="stringliteral">&quot;Could<sp/>not<sp/>resolve<sp/>operator<sp/>name&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>drink_request<sp/>=<sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1DescriptionStrDesignator_1a7ce2ca49dad6abee2022312f3677cbbc" kindref="member">drink_request_des</ref>.resolve()</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>drink_request:</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rospy.logerr(</highlight><highlight class="stringliteral">&quot;Could<sp/>not<sp/>resolve<sp/>drink<sp/>request&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1DescriptionStrDesignator_1ae4a1e24327538d4a60d0f2c72f7583a4" kindref="member">message_type</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&quot;found_operator&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Hey<sp/>{name},<sp/>I&apos;m<sp/>bringing<sp/>your<sp/>{drink}&quot;</highlight><highlight class="normal">.format(name=operator_name,<sp/>drink=drink_request)</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1DescriptionStrDesignator_1ae4a1e24327538d4a60d0f2c72f7583a4" kindref="member">message_type</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&quot;not_found_operator&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Hey<sp/>{name}<sp/>I&apos;m<sp/>back.&quot;</highlight><highlight class="normal">\</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Please<sp/>come<sp/>to<sp/>me<sp/>to<sp/>receive<sp/>your<sp/>{drink}&quot;</highlight><highlight class="normal">.format(name=operator_name,<sp/>drink=drink_request)</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1DescriptionStrDesignator_1ae4a1e24327538d4a60d0f2c72f7583a4" kindref="member">message_type</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&quot;fallback_bar&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Oh,<sp/>I<sp/>cannot<sp/>inspect<sp/>the<sp/>bar.<sp/>Please<sp/>hand<sp/>me<sp/>over<sp/>the<sp/>{drink}&quot;</highlight><highlight class="normal">.format(drink=drink_request)</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1DescriptionStrDesignator_1ae4a1e24327538d4a60d0f2c72f7583a4" kindref="member">message_type</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&quot;confirmation_available&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;I<sp/>understood<sp/>that<sp/>you<sp/>would<sp/>like<sp/>{drink},<sp/>is<sp/>that<sp/>correct?&quot;</highlight><highlight class="normal">.format(drink=drink_request)</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classchallenge__serving__drinks_1_1sd__states_1_1DescriptionStrDesignator_1ae4a1e24327538d4a60d0f2c72f7583a4" kindref="member">message_type</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&quot;state_unavailable&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>random.choice([</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Unfortunately<sp/>we<sp/>don&apos;t<sp/>have<sp/>{drink}&quot;</highlight><highlight class="normal">.format(drink=drink_request),</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;The<sp/>requested<sp/>{drink}<sp/>is<sp/>unavailable&quot;</highlight><highlight class="normal">.format(drink=drink_request),</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;I&apos;m<sp/>sorry<sp/>but<sp/>{drink}<sp/>is<sp/>out<sp/>of<sp/>stock&quot;</highlight><highlight class="normal">.format(drink=drink_request),</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>])</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rospy.logerr(</highlight><highlight class="stringliteral">&quot;No<sp/>correct<sp/>message<sp/>type<sp/>defined<sp/>for<sp/>DescriptionStrDesignator&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="370"><highlight class="normal"></highlight></codeline>
<codeline lineno="371"><highlight class="normal"></highlight></codeline>
<codeline lineno="372"><highlight class="normal"></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>__name__<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;__main__&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="373"><highlight class="normal"></highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Test<sp/>code</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="375"><highlight class="normal"></highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/>rospy.init_node(</highlight><highlight class="stringliteral">&apos;get_drinks&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="377"><highlight class="normal"></highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>robot_skills.get_robot<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>get_robot_from_argv</highlight></codeline>
<codeline lineno="379"><highlight class="normal"></highlight></codeline>
<codeline lineno="380" refid="namespacechallenge__serving__drinks_1_1sd__states_1abebcb39c14920ffcc409b4a273671b4b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>_robot<sp/>=<sp/>get_robot_from_argv(index=1)</highlight></codeline>
<codeline lineno="381"><highlight class="normal"></highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/>rospy.loginfo(</highlight><highlight class="stringliteral">&quot;Waiting<sp/>for<sp/>tf<sp/>cache<sp/>to<sp/>be<sp/>filled&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/>rospy.sleep(0.5)<sp/><sp/></highlight><highlight class="comment">#<sp/>wait<sp/>for<sp/>tf<sp/>cache<sp/>to<sp/>be<sp/>filled</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="384"><highlight class="normal"></highlight></codeline>
<codeline lineno="385" refid="namespacechallenge__serving__drinks_1_1sd__states_1a820291af8ef1c7c69aaa9d8e463928b5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>state<sp/>=<sp/><ref refid="classchallenge__serving__drinks_1_1sd__states_1_1AskDrink" kindref="compound">AskDrink</ref>(robot=_robot,</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>drink_designator=ds.VariableDesignator(resolve_type=str).writeable)</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/>state.execute(</highlight><highlight class="keywordtype">None</highlight><highlight class="normal">)</highlight></codeline>
    </programlisting>
    <location file="src/challenge_serving_drinks/sd_states.py"/>
  </compounddef>
</doxygen>
