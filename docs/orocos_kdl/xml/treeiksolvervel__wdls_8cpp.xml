<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.17">
  <compounddef id="treeiksolvervel__wdls_8cpp" kind="file" language="C++">
    <compoundname>treeiksolvervel_wdls.cpp</compoundname>
    <includes refid="treeiksolvervel__wdls_8hpp" local="yes">treeiksolvervel_wdls.hpp</includes>
    <includes refid="svd__eigen__HH_8hpp" local="yes">utilities/svd_eigen_HH.hpp</includes>
    <incdepgraph>
      <node id="3">
        <label>treeiksolver.hpp</label>
        <link refid="treeiksolver_8hpp"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
      </node>
      <node id="20">
        <label>exception</label>
        <link refid="cpp/header/exception" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml"/>
      </node>
      <node id="14">
        <label>functional</label>
        <link refid="cpp/header/functional" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml"/>
      </node>
      <node id="29">
        <label>algorithm</label>
        <link refid="cpp/header/algorithm" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml"/>
      </node>
      <node id="13">
        <label>utilities/hash_combine.h</label>
        <link refid="hash__combine_8h"/>
        <childnode refid="14" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>treeiksolvervel_wdls.hpp</label>
        <link refid="treeiksolvervel__wdls_8hpp"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
      </node>
      <node id="21">
        <label>vector</label>
        <link refid="cpp/header/vector" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml"/>
      </node>
      <node id="18">
        <label>joint.hpp</label>
        <link refid="joint_8hpp"/>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
      </node>
      <node id="10">
        <label>cstdlib</label>
        <link refid="cpp/header/cstdlib" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml"/>
      </node>
      <node id="16">
        <label>rigidbodyinertia.hpp</label>
        <link refid="rigidbodyinertia_8hpp"/>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
      </node>
      <node id="26">
        <label>Eigen/Core</label>
      </node>
      <node id="28">
        <label>utilities/svd_eigen_HH.hpp</label>
        <link refid="svd__eigen__HH_8hpp"/>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
      </node>
      <node id="7">
        <label>frames.hpp</label>
        <link refid="frames_8hpp"/>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
      </node>
      <node id="25">
        <label>jacobian.hpp</label>
        <link refid="jacobian_8hpp"/>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>treeiksolvervel_wdls.cpp</label>
        <link refid="treeiksolvervel__wdls_8cpp"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
      </node>
      <node id="23">
        <label>map</label>
        <link refid="cpp/header/map" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml"/>
      </node>
      <node id="11">
        <label>cassert</label>
        <link refid="cpp/header/cassert" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml"/>
      </node>
      <node id="9">
        <label>utilities/utility.h</label>
        <link refid="utility_8h"/>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
      </node>
      <node id="27">
        <label>treejnttojacsolver.hpp</label>
        <link refid="treejnttojacsolver_8hpp"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
      </node>
      <node id="15">
        <label>frames.inl</label>
        <link refid="frames_8inl"/>
      </node>
      <node id="4">
        <label>tree.hpp</label>
        <link refid="tree_8hpp"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
      </node>
      <node id="6">
        <label>segment.hpp</label>
        <link refid="segment_8hpp"/>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
      </node>
      <node id="24">
        <label>jntarray.hpp</label>
        <link refid="jntarray_8hpp"/>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
      </node>
      <node id="19">
        <label>string</label>
        <link refid="cpp/header/string" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml"/>
      </node>
      <node id="22">
        <label>chain.hpp</label>
        <link refid="chain_8hpp"/>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
      </node>
      <node id="17">
        <label>rotationalinertia.hpp</label>
        <link refid="rotationalinertia_8hpp"/>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="5">
        <label>config.h</label>
      </node>
      <node id="12">
        <label>cmath</label>
        <link refid="cpp/header/cmath" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml"/>
      </node>
      <node id="8">
        <label>utilities/kdl-config.h</label>
        <link refid="kdl-config_8h"/>
      </node>
    </incdepgraph>
    <innernamespace refid="namespaceKDL">KDL</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>TreeIkSolverVel_wdls.cpp</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/><sp/>Created<sp/>on:<sp/>Nov<sp/>28,<sp/>2008</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>Author:<sp/>rubensmits</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="treeiksolvervel__wdls_8hpp" kindref="compound">treeiksolvervel_wdls.hpp</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="svd__eigen__HH_8hpp" kindref="compound">utilities/svd_eigen_HH.hpp</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal"><ref refid="namespaceKDL" kindref="compound">KDL</ref><sp/>{<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="12" refid="classKDL_1_1TreeIkSolverVel__wdls_1a63a76294e5e67ff40ba3206e950bdb8f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a63a76294e5e67ff40ba3206e950bdb8f" kindref="member">TreeIkSolverVel_wdls::TreeIkSolverVel_wdls</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classKDL_1_1Tree" kindref="compound">Tree</ref>&amp;<sp/>tree_in,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="cpp/container/vector" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">std::vector&lt;std::string&gt;</ref>&amp;<sp/>endpoints)<sp/>:</highlight></codeline>
<codeline lineno="13"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tree(tree_in),<sp/>jnttojacsolver(tree),</highlight></codeline>
<codeline lineno="14"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J(Eigen::MatrixXd::Zero(6<sp/>*<sp/>endpoints.size(),<sp/>tree.getNrOfJoints())),</highlight></codeline>
<codeline lineno="15"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Wy(Eigen::MatrixXd::Identity(J.rows(),J.rows())),</highlight></codeline>
<codeline lineno="16"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Wq(Eigen::MatrixXd::Identity(J.cols(),J.cols())),</highlight></codeline>
<codeline lineno="17"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J_Wq(J.rows(),J.cols()),Wy_J_Wq(J.rows(),J.cols()),</highlight></codeline>
<codeline lineno="18"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>U(Eigen::MatrixXd::Identity(J.rows(),J.cols())),</highlight></codeline>
<codeline lineno="19"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>V(Eigen::MatrixXd::Identity(J.cols(),J.cols())),</highlight></codeline>
<codeline lineno="20"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Wy_U(J.rows(),J.rows()),Wq_V(J.cols(),J.cols()),</highlight></codeline>
<codeline lineno="21"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>t(Eigen::VectorXd::Zero(J.rows())),<sp/>Wy_t(Eigen::VectorXd::Zero(J.rows())),</highlight></codeline>
<codeline lineno="22"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qdot(Eigen::VectorXd::Zero(J.cols())),</highlight></codeline>
<codeline lineno="23"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tmp(Eigen::VectorXd::Zero(J.cols())),S(Eigen::VectorXd::Zero(J.cols())),</highlight></codeline>
<codeline lineno="24"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lambda(0)</highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>endpoints.<ref refid="cpp/container/vector/size" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">size</ref>();<sp/>++i)<sp/>{</highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a685cb7e634ae290656508981d0796c39" kindref="member">jacobians</ref>.<ref refid="cpp/container/map/insert" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">insert</ref>(Jacobians::value_type(endpoints[i],<sp/><ref refid="classKDL_1_1Jacobian" kindref="compound">Jacobian</ref>(<ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a88d05ff2a4d04de7f342e59e5d5fed4b" kindref="member">tree</ref>.<ref refid="classKDL_1_1Tree_1afd53537e6aeacc9f8a524f6ea90d1360" kindref="member">getNrOfJoints</ref>())));</highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="33" refid="classKDL_1_1TreeIkSolverVel__wdls_1a1f283c3a0acadd376eb7d5654369bd04" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a1f283c3a0acadd376eb7d5654369bd04" kindref="member">TreeIkSolverVel_wdls::~TreeIkSolverVel_wdls</ref>()<sp/>{</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="36" refid="classKDL_1_1TreeIkSolverVel__wdls_1a4386da9f7afa87c081d6dd616e17937d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a4386da9f7afa87c081d6dd616e17937d" kindref="member">TreeIkSolverVel_wdls::setWeightJS</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>Eigen::MatrixXd&amp;<sp/>Mq)<sp/>{</highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a6ea54773b88564f5e321fa4c7dcdace9" kindref="member">Wq</ref><sp/>=<sp/>Mq;</highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="40" refid="classKDL_1_1TreeIkSolverVel__wdls_1a845a862d5869a568daf57a901af394fc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a845a862d5869a568daf57a901af394fc" kindref="member">TreeIkSolverVel_wdls::setWeightTS</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>Eigen::MatrixXd&amp;<sp/>Mx)<sp/>{</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a5e47b7c18334f7d29a235dbbb269c412" kindref="member">Wy</ref><sp/>=<sp/>Mx;</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="44" refid="classKDL_1_1TreeIkSolverVel__wdls_1aa8a224fd34a83b8040705cf9e791d03a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1aa8a224fd34a83b8040705cf9e791d03a" kindref="member">TreeIkSolverVel_wdls::setLambda</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal">&amp;<sp/>lambda_in)<sp/>{</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a759b7e23c93a430fb64791133095ef09" kindref="member">lambda</ref><sp/>=<sp/>lambda_in;</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="48" refid="classKDL_1_1TreeIkSolverVel__wdls_1abf66f6cf12b0198206672a3162995f71" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1abf66f6cf12b0198206672a3162995f71" kindref="member">TreeIkSolverVel_wdls::CartToJnt</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classKDL_1_1JntArray" kindref="compound">JntArray</ref>&amp;<sp/>q_in,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="cpp/container/map" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">Twists</ref>&amp;<sp/>v_in,<sp/><ref refid="classKDL_1_1JntArray" kindref="compound">JntArray</ref>&amp;<sp/>qdot_out)<sp/>{</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//First<sp/>check<sp/>if<sp/>we<sp/>are<sp/>configured<sp/>for<sp/>this<sp/>Twists:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(Twists::const_iterator<sp/>v_it<sp/>=<sp/>v_in.<ref refid="cpp/container/map/begin" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">begin</ref>();<sp/>v_it<sp/>!=<sp/>v_in.<ref refid="cpp/container/map/end" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">end</ref>();<sp/>++v_it)<sp/>{</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a685cb7e634ae290656508981d0796c39" kindref="member">jacobians</ref>.<ref refid="cpp/container/map/find" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">find</ref>(v_it-&gt;first)<sp/>==<sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a685cb7e634ae290656508981d0796c39" kindref="member">jacobians</ref>.<ref refid="cpp/container/map/end" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">end</ref>())</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-2;</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Check<sp/>if<sp/>q_in<sp/>has<sp/>the<sp/>right<sp/>size</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(q_in.<ref refid="classKDL_1_1JntArray_1a3176b3c2ebbeeca6e45a3e8d4d692e5b" kindref="member">rows</ref>()<sp/>!=<sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a88d05ff2a4d04de7f342e59e5d5fed4b" kindref="member">tree</ref>.<ref refid="classKDL_1_1Tree_1afd53537e6aeacc9f8a524f6ea90d1360" kindref="member">getNrOfJoints</ref>())</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Lets<sp/>get<sp/>all<sp/>the<sp/>jacobians<sp/>we<sp/>need:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>k<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(Jacobians::iterator<sp/>jac_it<sp/>=<sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a685cb7e634ae290656508981d0796c39" kindref="member">jacobians</ref>.<ref refid="cpp/container/map/begin" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">begin</ref>();<sp/>jac_it</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>!=<sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a685cb7e634ae290656508981d0796c39" kindref="member">jacobians</ref>.<ref refid="cpp/container/map/end" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">end</ref>();<sp/>++jac_it)<sp/>{</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ret<sp/>=<sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a57b38bdee58095fdd2d090209d98bc3a" kindref="member">jnttojacsolver</ref>.<ref refid="classKDL_1_1TreeJntToJacSolver_1a81ea65b5ea13f9fd9e99a612fe5b6171" kindref="member">JntToJac</ref>(q_in,<sp/>jac_it-&gt;second,<sp/>jac_it-&gt;first);</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ret<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ret;</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//lets<sp/>put<sp/>the<sp/>jacobian<sp/>in<sp/>the<sp/>big<sp/>matrix<sp/>and<sp/>put<sp/>the<sp/>twist<sp/>in<sp/>the<sp/>big<sp/>t:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a429d704dd7e9ebfd07f61dda4694063a" kindref="member">J</ref>.block(6*k,0,<sp/>6,<ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a88d05ff2a4d04de7f342e59e5d5fed4b" kindref="member">tree</ref>.<ref refid="classKDL_1_1Tree_1afd53537e6aeacc9f8a524f6ea90d1360" kindref="member">getNrOfJoints</ref>())<sp/>=<sp/>jac_it-&gt;second.data;</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classKDL_1_1Twist" kindref="compound">Twist</ref>&amp;<sp/>twist=v_in.<ref refid="cpp/container/map/find" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">find</ref>(jac_it-&gt;first)-&gt;second;</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a3a4d0c9303672b8bec1d1fb5b28abccb" kindref="member">t</ref>.segment(6*k,3)<sp/><sp/><sp/>=<sp/>Eigen::Map&lt;const<sp/>Eigen::Vector3d&gt;(twist.<ref refid="classKDL_1_1Twist_1adda560fbd643ba2448d519fce626b680" kindref="member">vel</ref>.<ref refid="classKDL_1_1Vector_1a97106b4583f8e2ecf39ed7682b945bd1" kindref="member">data</ref>);</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a3a4d0c9303672b8bec1d1fb5b28abccb" kindref="member">t</ref>.segment(6*k+3,3)<sp/>=<sp/>Eigen::Map&lt;const<sp/>Eigen::Vector3d&gt;(twist.<ref refid="classKDL_1_1Twist_1a5ab2bb436b67c902e9c7735c4df16eba" kindref="member">rot</ref>.<ref refid="classKDL_1_1Vector_1a97106b4583f8e2ecf39ed7682b945bd1" kindref="member">data</ref>);</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>++k;</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Lets<sp/>use<sp/>the<sp/>wdls<sp/>algorithm<sp/>to<sp/>find<sp/>the<sp/>qdot:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Create<sp/>the<sp/>Weighted<sp/>jacobian</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1acb45a8405c692868551ba4bc2e7116dc" kindref="member">J_Wq</ref>.noalias()<sp/>=<sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a429d704dd7e9ebfd07f61dda4694063a" kindref="member">J</ref><sp/>*<sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a6ea54773b88564f5e321fa4c7dcdace9" kindref="member">Wq</ref>;</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1ad74037e05094f7fdae8e1d2b5d6cc9f2" kindref="member">Wy_J_Wq</ref>.noalias()<sp/>=<sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a5e47b7c18334f7d29a235dbbb269c412" kindref="member">Wy</ref><sp/>*<sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1acb45a8405c692868551ba4bc2e7116dc" kindref="member">J_Wq</ref>;</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Compute<sp/>the<sp/>SVD<sp/>of<sp/>the<sp/>weighted<sp/>jacobian</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ret<sp/>=<sp/><ref refid="namespaceKDL_1a018cd64c810b4538db502263927b2071" kindref="member">svd_eigen_HH</ref>(<ref refid="classKDL_1_1TreeIkSolverVel__wdls_1ad74037e05094f7fdae8e1d2b5d6cc9f2" kindref="member">Wy_J_Wq</ref>,<sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a6dcf16fe0d1434a75436642263363ab9" kindref="member">U</ref>,<sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a9eced55d3205a577f0361d25d4eb27cf" kindref="member">S</ref>,<sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a20b898e9a25ee1e2612d6a5bf5488070" kindref="member">V</ref>,<sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a1d4d53edc02033027cee0dd1bda6454d" kindref="member">tmp</ref>);</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ret<sp/>&lt;<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a532c5be4d009613a9a52bef66c736160" kindref="member">E_SVD_FAILED</ref>;</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Pre-multiply<sp/>U<sp/>and<sp/>V<sp/>by<sp/>the<sp/>task<sp/>space<sp/>and<sp/>joint<sp/>space<sp/>weighting<sp/>matrix<sp/>respectively</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a4bc8961d71e6ccbd191b4e9e6768091a" kindref="member">Wy_t</ref>.noalias()<sp/>=<sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a5e47b7c18334f7d29a235dbbb269c412" kindref="member">Wy</ref><sp/>*<sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a3a4d0c9303672b8bec1d1fb5b28abccb" kindref="member">t</ref>;</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a9c771e3d2b381994726d2bbdda24961a" kindref="member">Wq_V</ref>.noalias()<sp/>=<sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a6ea54773b88564f5e321fa4c7dcdace9" kindref="member">Wq</ref><sp/>*<sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a20b898e9a25ee1e2612d6a5bf5488070" kindref="member">V</ref>;</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>tmp<sp/>=<sp/>(Si*Wy*U&apos;*y),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a429d704dd7e9ebfd07f61dda4694063a" kindref="member">J</ref>.cols();<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sum<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a429d704dd7e9ebfd07f61dda4694063a" kindref="member">J</ref>.rows();<sp/>j++)<sp/>{</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>&lt;<sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a4bc8961d71e6ccbd191b4e9e6768091a" kindref="member">Wy_t</ref>.rows())</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sum<sp/>+=<sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a6dcf16fe0d1434a75436642263363ab9" kindref="member">U</ref>(j,<sp/>i)<sp/>*<sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a4bc8961d71e6ccbd191b4e9e6768091a" kindref="member">Wy_t</ref>(j);</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sum<sp/>+=<sp/>0.0;</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a1d4d53edc02033027cee0dd1bda6454d" kindref="member">tmp</ref>(<sp/>i)<sp/>=<sp/>sum<sp/>*<sp/>((<ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a9eced55d3205a577f0361d25d4eb27cf" kindref="member">S</ref>(i)<sp/>/<sp/>(<ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a9eced55d3205a577f0361d25d4eb27cf" kindref="member">S</ref>(i)<sp/>*<sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a9eced55d3205a577f0361d25d4eb27cf" kindref="member">S</ref>(i)<sp/>+<sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a759b7e23c93a430fb64791133095ef09" kindref="member">lambda</ref><sp/>*<sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a759b7e23c93a430fb64791133095ef09" kindref="member">lambda</ref>)));</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>x<sp/>=<sp/>Lx^-1*V*tmp<sp/>+<sp/>x</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qdot_out.<ref refid="classKDL_1_1JntArray_1a59dff4a2f3fa4adedb55c3384238dc74" kindref="member">data</ref>.noalias()<sp/>=<sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a9c771e3d2b381994726d2bbdda24961a" kindref="member">Wq_V</ref><sp/>*<sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a1d4d53edc02033027cee0dd1bda6454d" kindref="member">tmp</ref>;</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classKDL_1_1TreeIkSolverVel__wdls_1a4bc8961d71e6ccbd191b4e9e6768091a" kindref="member">Wy_t</ref>.norm();</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="106"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="src/treeiksolvervel_wdls.cpp"/>
  </compounddef>
</doxygen>
