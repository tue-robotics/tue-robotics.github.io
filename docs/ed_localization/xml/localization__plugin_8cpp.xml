<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.17">
  <compounddef id="localization__plugin_8cpp" kind="file" language="C++">
    <compoundname>localization_plugin.cpp</compoundname>
    <includes local="no">exception</includes>
    <includes refid="localization__plugin_8h" local="yes">localization_plugin.h</includes>
    <includes local="no">ros/node_handle.h</includes>
    <includes local="no">ros/subscribe_options.h</includes>
    <includes local="no">ed/world_model.h</includes>
    <includes local="no">ed/entity.h</includes>
    <includes local="no">opencv2/highgui/highgui.hpp</includes>
    <includes local="no">opencv2/imgproc/imgproc.hpp</includes>
    <includes local="no">tf2/LinearMath/Quaternion.h</includes>
    <includes local="no">tf2_geometry_msgs/tf2_geometry_msgs.h</includes>
    <includes local="no">tf2_ros/transform_broadcaster.h</includes>
    <includes local="no">tue/profiling/timer.h</includes>
    <includes local="no">geolib/Shape.h</includes>
    <includes local="no">geolib/Box.h</includes>
    <includes local="no">geolib/ros/msg_conversions.h</includes>
    <includes local="no">geolib/ros/tf2_conversions.h</includes>
    <includes local="no">geometry_msgs/PoseArray.h</includes>
    <includes local="no">geometry_msgs/TransformStamped.h</includes>
    <includes local="no">ed/update_request.h</includes>
    <incdepgraph>
      <node id="2">
        <label>exception</label>
        <link refid="cpp/header/exception" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml"/>
      </node>
      <node id="25">
        <label>functional</label>
        <link refid="cpp/header/functional" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml"/>
      </node>
      <node id="40">
        <label>geometry_msgs/PoseArray.h</label>
      </node>
      <node id="23">
        <label>laser_model.h</label>
        <link refid="laser__model_8h"/>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
      </node>
      <node id="39">
        <label>geolib/ros/tf2_conversions.h</label>
        <link refid="tf2__conversions_8h.html" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags"/>
      </node>
      <node id="9">
        <label>ros/publisher.h</label>
      </node>
      <node id="7">
        <label>ros/duration.h</label>
      </node>
      <node id="19">
        <label>vector</label>
        <link refid="cpp/header/vector" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml"/>
      </node>
      <node id="22">
        <label>odom_model.h</label>
        <link refid="odom__model_8h"/>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
      </node>
      <node id="13">
        <label>queue</label>
        <link refid="cpp/header/queue" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml"/>
      </node>
      <node id="37">
        <label>geolib/Box.h</label>
        <link refid="Box_8h.html" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags"/>
      </node>
      <node id="18">
        <label>memory</label>
        <link refid="cpp/header/memory" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml"/>
      </node>
      <node id="36">
        <label>geolib/Shape.h</label>
        <link refid="Shape_8h.html" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags"/>
      </node>
      <node id="33">
        <label>tf2_geometry_msgs/tf2_geometry_msgs.h</label>
      </node>
      <node id="5">
        <label>geolib/datatypes.h</label>
        <link refid="datatypes_8h.html" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags"/>
      </node>
      <node id="21">
        <label>tue/config/configuration.h</label>
        <link refid="configuration_8h.html" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags"/>
      </node>
      <node id="15">
        <label>particle_filter.h</label>
        <link refid="particle__filter_8h"/>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
      </node>
      <node id="41">
        <label>geometry_msgs/TransformStamped.h</label>
      </node>
      <node id="12">
        <label>geometry_msgs/PoseWithCovarianceStamped.h</label>
      </node>
      <node id="31">
        <label>opencv2/imgproc/imgproc.hpp</label>
      </node>
      <node id="1">
        <label>localization_plugin.cpp</label>
        <link refid="localization__plugin_8cpp"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="30" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="32" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
        <childnode refid="35" relation="include">
        </childnode>
        <childnode refid="36" relation="include">
        </childnode>
        <childnode refid="37" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
        <childnode refid="40" relation="include">
        </childnode>
        <childnode refid="41" relation="include">
        </childnode>
        <childnode refid="42" relation="include">
        </childnode>
      </node>
      <node id="3">
        <label>localization_plugin.h</label>
        <link refid="localization__plugin_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
      </node>
      <node id="27">
        <label>ros/subscribe_options.h</label>
      </node>
      <node id="17">
        <label>array</label>
        <link refid="cpp/header/array" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml"/>
      </node>
      <node id="10">
        <label>ros/callback_queue.h</label>
      </node>
      <node id="35">
        <label>tue/profiling/timer.h</label>
        <link refid="timer_8h.html" external="/home/docker/ros/noetic/system/build/docs/code_profiler/tags"/>
      </node>
      <node id="14">
        <label>tf2/transform_datatypes.h</label>
      </node>
      <node id="30">
        <label>opencv2/highgui/highgui.hpp</label>
      </node>
      <node id="20">
        <label>geolib/math_types.h</label>
        <link refid="math__types_8h.html" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags"/>
      </node>
      <node id="24">
        <label>ed/types.h</label>
        <link refid="types_8h.html" external="/home/docker/ros/noetic/system/build/docs/ed/tags"/>
      </node>
      <node id="8">
        <label>ros/subscriber.h</label>
      </node>
      <node id="38">
        <label>geolib/ros/msg_conversions.h</label>
        <link refid="msg__conversions_8h.html" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags"/>
      </node>
      <node id="32">
        <label>tf2/LinearMath/Quaternion.h</label>
      </node>
      <node id="29">
        <label>ed/entity.h</label>
        <link refid="entity_8h.html" external="/home/docker/ros/noetic/system/build/docs/ed/tags"/>
      </node>
      <node id="16">
        <label>kdtree.h</label>
        <link refid="kdtree_8h"/>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
      </node>
      <node id="34">
        <label>tf2_ros/transform_broadcaster.h</label>
      </node>
      <node id="11">
        <label>sensor_msgs/LaserScan.h</label>
      </node>
      <node id="26">
        <label>ros/node_handle.h</label>
      </node>
      <node id="4">
        <label>ed/plugin.h</label>
        <link refid="plugin_8h.html" external="/home/docker/ros/noetic/system/build/docs/ed/tags"/>
      </node>
      <node id="42">
        <label>ed/update_request.h</label>
        <link refid="update__request_8h.html" external="/home/docker/ros/noetic/system/build/docs/ed/tags"/>
      </node>
      <node id="28">
        <label>ed/world_model.h</label>
        <link refid="world__model_8h.html" external="/home/docker/ros/noetic/system/build/docs/ed/tags"/>
      </node>
      <node id="6">
        <label>geolib/sensors/LaserRangeFinder.h</label>
        <link refid="LaserRangeFinder_8h.html" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags"/>
      </node>
    </incdepgraph>
    <innerclass refid="classConfigurationException" prot="public">ConfigurationException</innerclass>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="preprocessor">#include<sp/>&lt;<ref refid="cpp/header/exception" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">exception</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="localization__plugin_8h" kindref="compound">localization_plugin.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;ros/node_handle.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;ros/subscribe_options.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="world__model_8h.html" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/ed/tags">ed/world_model.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="entity_8h.html" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/ed/tags">ed/entity.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;opencv2/highgui/highgui.hpp&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;opencv2/imgproc/imgproc.hpp&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;tf2/LinearMath/Quaternion.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;tf2_geometry_msgs/tf2_geometry_msgs.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;tf2_ros/transform_broadcaster.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="timer_8h.html" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/code_profiler/tags">tue/profiling/timer.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="Shape_8h.html" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geolib/Shape.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="Box_8h.html" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geolib/Box.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="msg__conversions_8h.html" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geolib/ros/msg_conversions.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="tf2__conversions_8h.html" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geolib/ros/tf2_conversions.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;geometry_msgs/PoseArray.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;geometry_msgs/TransformStamped.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="update__request_8h.html" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/ed/tags">ed/update_request.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight></codeline>
<codeline lineno="29" refid="classConfigurationException" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classConfigurationException" kindref="compound">ConfigurationException</ref>:<sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="cpp/error/exception" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">std::exception</ref></highlight></codeline>
<codeline lineno="30"><highlight class="normal">{</highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="keyword">public</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="32" refid="classConfigurationException_1ad08edf483f9f86287c7687b74451f386" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classConfigurationException_1ad08edf483f9f86287c7687b74451f386" kindref="member">ConfigurationException</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="cpp/string/basic_string" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">std::string</ref>&amp;<sp/>msg){<ref refid="classConfigurationException_1ab0852d61165c8f4499c4ad2c4575df70" kindref="member">message_</ref><sp/>=<sp/>msg;}</highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight></codeline>
<codeline lineno="34" refid="classConfigurationException_1ab3535f7c8b14e9c689a05436a3a6ba9c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/><ref refid="classConfigurationException_1ab3535f7c8b14e9c689a05436a3a6ba9c" kindref="member">what</ref>()<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>throw()</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classConfigurationException_1ab0852d61165c8f4499c4ad2c4575df70" kindref="member">message_</ref>.<ref refid="cpp/string/basic_string/c_str" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">c_str</ref>();</highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="39" refid="classConfigurationException_1ab0852d61165c8f4499c4ad2c4575df70" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="cpp/string/basic_string" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">std::string</ref><sp/><ref refid="classConfigurationException_1ab0852d61165c8f4499c4ad2c4575df70" kindref="member">message_</ref>;</highlight></codeline>
<codeline lineno="40"><highlight class="normal">};</highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="comment">//<sp/>----------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight></codeline>
<codeline lineno="44" refid="classLocalizationPlugin_1a0559cbbc614ee476703e8f45356116db" refkind="member"><highlight class="normal"><ref refid="classLocalizationPlugin_1a0559cbbc614ee476703e8f45356116db" kindref="member">LocalizationPlugin::LocalizationPlugin</ref>()<sp/>:</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/>visualize_(false),</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/>resample_interval_(1),</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/>resample_count_(0),</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/>update_min_d_(0),</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/>update_min_a_(0),</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/>have_previous_odom_pose_(false),</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/>latest_map_odom_valid_(false),</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/>update_(false),</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/>laser_offset_initialized_(false),</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/>last_map_size_revision_(0),</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/>tf_broadcaster_(nullptr)</highlight></codeline>
<codeline lineno="56"><highlight class="normal">{</highlight></codeline>
<codeline lineno="57"><highlight class="normal">}</highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight><highlight class="comment">//<sp/>----------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight></codeline>
<codeline lineno="61" refid="classLocalizationPlugin_1ac97a02a2d133fda0ba8985c14ab36cc6" refkind="member"><highlight class="normal"><ref refid="classLocalizationPlugin_1ac97a02a2d133fda0ba8985c14ab36cc6" kindref="member">LocalizationPlugin::~LocalizationPlugin</ref>()</highlight></codeline>
<codeline lineno="62"><highlight class="normal">{</highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Get<sp/>transform<sp/>between<sp/>map<sp/>and<sp/>odom<sp/>frame</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>geometry_msgs::TransformStamped<sp/>ts<sp/>=<sp/><ref refid="classed_1_1Plugin_1a3c2f7b0513527158853dbc04ffcc8238" kindref="member" external="/home/docker/ros/noetic/system/build/docs/ed/tags">tf_buffer_</ref>-&gt;lookupTransform(<ref refid="classLocalizationPlugin_1a582b4df5eff61a67233084ebe7905286" kindref="member">map_frame_id_</ref>,<sp/><ref refid="classLocalizationPlugin_1a5f64585d0b1622f3335900dc4991d518" kindref="member">odom_frame_id_</ref>,<sp/>ros::Time(0));</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tf2::Quaternion<sp/>rotation_map_odom;</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tf2::convert(ts.transform.rotation,<sp/>rotation_map_odom);<sp/></highlight><highlight class="comment">//<sp/>Returns<sp/>a<sp/>quaternion</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Store<sp/>the<sp/>x,<sp/>y<sp/>and<sp/>yaw<sp/>on<sp/>the<sp/>parameter<sp/>server</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ros::NodeHandle<sp/>nh;</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nh.setParam(</highlight><highlight class="stringliteral">&quot;initial_pose/x&quot;</highlight><highlight class="normal">,<sp/>ts.transform.translation.x);</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nh.setParam(</highlight><highlight class="stringliteral">&quot;initial_pose/y&quot;</highlight><highlight class="normal">,<sp/>ts.transform.translation.y);</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nh.setParam(</highlight><highlight class="stringliteral">&quot;initial_pose/yaw&quot;</highlight><highlight class="normal">,<sp/>rotation_map_odom.getAngle());</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">catch</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>tf2::TransformException&amp;<sp/>ex)</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ROS_ERROR_STREAM_NAMED(</highlight><highlight class="stringliteral">&quot;Localization&quot;</highlight><highlight class="normal">,<sp/>ex.what());</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="81"><highlight class="normal">}</highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight><highlight class="comment">//<sp/>----------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="84"><highlight class="normal"></highlight></codeline>
<codeline lineno="85" refid="classLocalizationPlugin_1aa29e0fbc546007899f7a7dfa5347b1e0" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classLocalizationPlugin_1aa29e0fbc546007899f7a7dfa5347b1e0" kindref="member">LocalizationPlugin::configure</ref>(<ref refid="classtue_1_1config_1_1ReaderWriter" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">tue::Configuration</ref><sp/>config)</highlight></codeline>
<codeline lineno="86"><highlight class="normal">{</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1ab3afbf96373364bf73ae34d657bdc8af" kindref="member">tf_broadcaster_</ref><sp/>=<sp/>std::make_unique&lt;tf2_ros::TransformBroadcaster&gt;();</highlight></codeline>
<codeline lineno="88"><highlight class="normal"></highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1a75ad0dd7d5715c85f1a293287fedaa05" kindref="member">visualize_</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>.<ref refid="classtue_1_1config_1_1ReaderWriter_1a6b49f39a05ada8016feb604bb2f801e8" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">value</ref>(</highlight><highlight class="stringliteral">&quot;visualize&quot;</highlight><highlight class="normal">,<sp/><ref refid="classLocalizationPlugin_1a75ad0dd7d5715c85f1a293287fedaa05" kindref="member">visualize_</ref>,<sp/><ref refid="namespacetue_1_1config_1a1ad7ac2e22b2d2ecdbdab22fea6f8eeba4a665c52d925f41ad398fcca3a82f5cb" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">tue::config::OPTIONAL</ref>);</highlight></codeline>
<codeline lineno="91"><highlight class="normal"></highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>.<ref refid="classtue_1_1config_1_1ReaderWriter_1a6b49f39a05ada8016feb604bb2f801e8" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">value</ref>(</highlight><highlight class="stringliteral">&quot;resample_interval&quot;</highlight><highlight class="normal">,<sp/><ref refid="classLocalizationPlugin_1a8a765de871047be859057021f81223d2" kindref="member">resample_interval_</ref>);</highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>.<ref refid="classtue_1_1config_1_1ReaderWriter_1a6b49f39a05ada8016feb604bb2f801e8" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">value</ref>(</highlight><highlight class="stringliteral">&quot;update_min_d&quot;</highlight><highlight class="normal">,<sp/><ref refid="classLocalizationPlugin_1a8568afa17d7534fb1cfdebea84fe8740" kindref="member">update_min_d_</ref>);</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>.<ref refid="classtue_1_1config_1_1ReaderWriter_1a6b49f39a05ada8016feb604bb2f801e8" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">value</ref>(</highlight><highlight class="stringliteral">&quot;update_min_a&quot;</highlight><highlight class="normal">,<sp/><ref refid="classLocalizationPlugin_1ab8b3e51465560c525cc37d006027d530" kindref="member">update_min_a_</ref>);</highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="cpp/string/basic_string" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">std::string</ref><sp/>laser_topic;</highlight></codeline>
<codeline lineno="98"><highlight class="normal"></highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>.<ref refid="classtue_1_1config_1_1ReaderWriter_1afad170974e5aaf82a3489ae23365f875" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">readGroup</ref>(</highlight><highlight class="stringliteral">&quot;odom_model&quot;</highlight><highlight class="normal">,<sp/><ref refid="namespacetue_1_1config_1a1ad7ac2e22b2d2ecdbdab22fea6f8eeba0ec9805a558257d9f2760c0769646cd8" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">tue::config::REQUIRED</ref>))</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>.<ref refid="classtue_1_1config_1_1ReaderWriter_1a6b49f39a05ada8016feb604bb2f801e8" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">value</ref>(</highlight><highlight class="stringliteral">&quot;map_frame&quot;</highlight><highlight class="normal">,<sp/><ref refid="classLocalizationPlugin_1a582b4df5eff61a67233084ebe7905286" kindref="member">map_frame_id_</ref>);</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>.<ref refid="classtue_1_1config_1_1ReaderWriter_1a6b49f39a05ada8016feb604bb2f801e8" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">value</ref>(</highlight><highlight class="stringliteral">&quot;odom_frame&quot;</highlight><highlight class="normal">,<sp/><ref refid="classLocalizationPlugin_1a5f64585d0b1622f3335900dc4991d518" kindref="member">odom_frame_id_</ref>);</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>.<ref refid="classtue_1_1config_1_1ReaderWriter_1a6b49f39a05ada8016feb604bb2f801e8" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">value</ref>(</highlight><highlight class="stringliteral">&quot;base_link_frame&quot;</highlight><highlight class="normal">,<sp/><ref refid="classLocalizationPlugin_1af331d2a967d487d8f0d7814db64c3894" kindref="member">base_link_frame_id_</ref>);</highlight></codeline>
<codeline lineno="104"><highlight class="normal"></highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1a5a57f0fa74809ce2611fcd22bf1075a5" kindref="member">odom_model_</ref>.<ref refid="classOdomModel_1ac426e4e3a9eaf9a5dab1ce0a895b03c1" kindref="member">configure</ref>(<ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>);</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>.<ref refid="classtue_1_1config_1_1ReaderWriter_1aa2955d31c9ea83ef3e7949b49fe4c051" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">endGroup</ref>();</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>.<ref refid="classtue_1_1config_1_1ReaderWriter_1afad170974e5aaf82a3489ae23365f875" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">readGroup</ref>(</highlight><highlight class="stringliteral">&quot;laser_model&quot;</highlight><highlight class="normal">,<sp/><ref refid="namespacetue_1_1config_1a1ad7ac2e22b2d2ecdbdab22fea6f8eeba0ec9805a558257d9f2760c0769646cd8" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">tue::config::REQUIRED</ref>))</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>.<ref refid="classtue_1_1config_1_1ReaderWriter_1a6b49f39a05ada8016feb604bb2f801e8" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">value</ref>(</highlight><highlight class="stringliteral">&quot;topic&quot;</highlight><highlight class="normal">,<sp/>laser_topic);</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1aba89e1770526c9705f2f8f07c25118dc" kindref="member">laser_model_</ref>.<ref refid="classLaserModel_1abd94a7728bff9460b9c03b4e3500eed1" kindref="member">configure</ref>(<ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>);</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>.<ref refid="classtue_1_1config_1_1ReaderWriter_1aa2955d31c9ea83ef3e7949b49fe4c051" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">endGroup</ref>();</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="115"><highlight class="normal"></highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>.<ref refid="classtue_1_1config_1_1ReaderWriter_1afad170974e5aaf82a3489ae23365f875" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">readGroup</ref>(</highlight><highlight class="stringliteral">&quot;particle_filter&quot;</highlight><highlight class="normal">,<sp/><ref refid="namespacetue_1_1config_1a1ad7ac2e22b2d2ecdbdab22fea6f8eeba0ec9805a558257d9f2760c0769646cd8" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">tue::config::REQUIRED</ref>))</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1a36cfa1be4e485cc98a50bb8df493f9af" kindref="member">particle_filter_</ref>.<ref refid="classParticleFilter_1ac1fa61bd8fb20df7bccd260a707cdd74" kindref="member">configure</ref>(<ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>);</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>.<ref refid="classtue_1_1config_1_1ReaderWriter_1aa2955d31c9ea83ef3e7949b49fe4c051" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">endGroup</ref>();</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="121"><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>tmp_transform_tolerance<sp/>=<sp/>0.1;</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>.<ref refid="classtue_1_1config_1_1ReaderWriter_1a6b49f39a05ada8016feb604bb2f801e8" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">value</ref>(</highlight><highlight class="stringliteral">&quot;transform_tolerance&quot;</highlight><highlight class="normal">,<sp/>tmp_transform_tolerance,<sp/><ref refid="namespacetue_1_1config_1a1ad7ac2e22b2d2ecdbdab22fea6f8eeba4a665c52d925f41ad398fcca3a82f5cb" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">tue::config::OPTIONAL</ref>);</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1a9cc267422db35c3c5c15c8c1d5c6d24b" kindref="member">transform_tolerance_</ref>.fromSec(tmp_transform_tolerance);</highlight></codeline>
<codeline lineno="125"><highlight class="normal"></highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>.<ref refid="classtue_1_1config_1_1ReaderWriter_1aca1899a8a8e02880e49d08ac65d675af" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">hasError</ref>())</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="128"><highlight class="normal"></highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/>ros::NodeHandle<sp/>nh;</highlight></codeline>
<codeline lineno="130"><highlight class="normal"></highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Subscribe<sp/>to<sp/>laser<sp/>topic</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/>ros::SubscribeOptions<sp/>sub_options<sp/>=</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ros::SubscribeOptions::create&lt;sensor_msgs::LaserScan&gt;(</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>laser_topic,<sp/>1,<sp/>boost::bind(&amp;<ref refid="classLocalizationPlugin_1a0906c04c237e5ea3b730a327451b83d1" kindref="member">LocalizationPlugin::laserCallback</ref>,<sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/>_1),<sp/>ros::VoidPtr(),<sp/>&amp;<ref refid="classLocalizationPlugin_1ab318464d02d0c0c8c05543971f7029c5" kindref="member">cb_queue_</ref>);</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1a34456a6d0f9bb4a5d0179a31cd5c520d" kindref="member">sub_laser_</ref><sp/>=<sp/>nh.subscribe(sub_options);</highlight></codeline>
<codeline lineno="136"><highlight class="normal"></highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="cpp/string/basic_string" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">std::string</ref><sp/>initial_pose_topic;</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>.<ref refid="classtue_1_1config_1_1ReaderWriter_1a6b49f39a05ada8016feb604bb2f801e8" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">value</ref>(</highlight><highlight class="stringliteral">&quot;initial_pose_topic&quot;</highlight><highlight class="normal">,<sp/>initial_pose_topic,<sp/><ref refid="namespacetue_1_1config_1a1ad7ac2e22b2d2ecdbdab22fea6f8eeba4a665c52d925f41ad398fcca3a82f5cb" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">tue::config::OPTIONAL</ref>))</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Subscribe<sp/>to<sp/>initial<sp/>pose<sp/>topic</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ros::SubscribeOptions<sp/>sub_opts<sp/>=</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ros::SubscribeOptions::create&lt;geometry_msgs::PoseWithCovarianceStamped&gt;(</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>initial_pose_topic,<sp/>1,<sp/>boost::bind(&amp;<ref refid="classLocalizationPlugin_1a244820f6fb36a80c52d7e17a77ef13b9" kindref="member">LocalizationPlugin::initialPoseCallback</ref>,<sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/>_1),<sp/>ros::VoidPtr(),<sp/>&amp;<ref refid="classLocalizationPlugin_1ab318464d02d0c0c8c05543971f7029c5" kindref="member">cb_queue_</ref>);</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1a44725213913c53143ec8e5ba56ebd336" kindref="member">sub_initial_pose_</ref><sp/>=<sp/>nh.subscribe(sub_opts);</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="146"><highlight class="normal"></highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classgeo_1_1Transform2T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Transform2d</ref><sp/>initial_pose<sp/>=<sp/><ref refid="classLocalizationPlugin_1a7fc6b6ac7dc96e4ca26cd63123fac958" kindref="member">getInitialPose</ref>(nh,<sp/><ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>);</highlight></codeline>
<codeline lineno="148"><highlight class="normal"></highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1a648acd040eb409b43f7e561426166894" kindref="member">initParticleFilterUniform</ref>(initial_pose);</highlight></codeline>
<codeline lineno="150"><highlight class="normal"></highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>.<ref refid="classtue_1_1config_1_1ReaderWriter_1a6b49f39a05ada8016feb604bb2f801e8" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">value</ref>(</highlight><highlight class="stringliteral">&quot;robot_name&quot;</highlight><highlight class="normal">,<sp/><ref refid="classLocalizationPlugin_1a662b8389b5f676d95a33e2f998e8a517" kindref="member">robot_name_</ref>);</highlight></codeline>
<codeline lineno="152"><highlight class="normal"></highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1afb3da7dc518a25c59eca0ab9092d2234" kindref="member">pub_particles_</ref><sp/>=<sp/>nh.advertise&lt;geometry_msgs::PoseArray&gt;(</highlight><highlight class="stringliteral">&quot;ed/localization/particles&quot;</highlight><highlight class="normal">,<sp/>10);</highlight></codeline>
<codeline lineno="154"><highlight class="normal">}</highlight></codeline>
<codeline lineno="155"><highlight class="normal"></highlight></codeline>
<codeline lineno="156"><highlight class="normal"></highlight><highlight class="comment">//<sp/>----------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="157"><highlight class="normal"></highlight></codeline>
<codeline lineno="158" refid="classLocalizationPlugin_1a7fc6b6ac7dc96e4ca26cd63123fac958" refkind="member"><highlight class="normal"><ref refid="classgeo_1_1Transform2T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Transform2d</ref><sp/><ref refid="classLocalizationPlugin_1a7fc6b6ac7dc96e4ca26cd63123fac958" kindref="member">LocalizationPlugin::getInitialPose</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>ros::NodeHandle&amp;<sp/>nh,<sp/><ref refid="classtue_1_1config_1_1ReaderWriter" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">tue::Configuration</ref>&amp;<sp/>config)</highlight></codeline>
<codeline lineno="159"><highlight class="normal">{</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classLocalizationPlugin_1a7c2e270fde46c9187747448efd4624bb" kindref="member">tryGetInitialPoseFromParamServer</ref>(nh);</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">catch</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classConfigurationException" kindref="compound">ConfigurationException</ref>&amp;)</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="167"><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classLocalizationPlugin_1adf4151431acb06c1167fb1894d4d55bd" kindref="member">tryGetInitialPoseFromConfig</ref>(<ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>);</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">catch</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classConfigurationException" kindref="compound">ConfigurationException</ref>&amp;)</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="175"><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classgeo_1_1Transform2T_1adffa0220c50793d90669471c0f4d3bd6" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Transform2d::identity</ref>();</highlight></codeline>
<codeline lineno="177"><highlight class="normal">}</highlight></codeline>
<codeline lineno="178"><highlight class="normal"></highlight></codeline>
<codeline lineno="179"><highlight class="normal"></highlight><highlight class="comment">//<sp/>----------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"></highlight></codeline>
<codeline lineno="181" refid="classLocalizationPlugin_1a7c2e270fde46c9187747448efd4624bb" refkind="member"><highlight class="normal"><ref refid="classgeo_1_1Transform2T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Transform2</ref><sp/><ref refid="classLocalizationPlugin_1a7c2e270fde46c9187747448efd4624bb" kindref="member">LocalizationPlugin::tryGetInitialPoseFromParamServer</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>ros::NodeHandle&amp;<sp/>nh)</highlight></codeline>
<codeline lineno="182"><highlight class="normal">{</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Getting<sp/>last<sp/>pose<sp/>from<sp/>parameter<sp/>server</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="cpp/container/map" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">std::map&lt;std::string, double&gt;</ref><sp/>ros_param_position;</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!nh.getParam(</highlight><highlight class="stringliteral">&quot;initial_pose&quot;</highlight><highlight class="normal">,<sp/>ros_param_position))</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cpp/string/basic_string" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">std::string</ref><sp/>msg<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Could<sp/>not<sp/>read<sp/>initial<sp/>pose<sp/>from<sp/>the<sp/>parameter<sp/>server&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ROS_WARN_STREAM_NAMED(</highlight><highlight class="stringliteral">&quot;Localization&quot;</highlight><highlight class="normal">,<sp/>msg);</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/><ref refid="classConfigurationException" kindref="compound">ConfigurationException</ref>(msg);</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="191"><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Make<sp/>a<sp/>homogeneous<sp/>transformation<sp/>with<sp/>the<sp/>variables<sp/>from<sp/>the<sp/>parameter<sp/>server</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/>tf2::Transform<sp/>homogtrans_map_odom;</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/>homogtrans_map_odom.setOrigin(tf2::Vector3(ros_param_position[</highlight><highlight class="stringliteral">&quot;x&quot;</highlight><highlight class="normal">],<sp/>ros_param_position[</highlight><highlight class="stringliteral">&quot;y&quot;</highlight><highlight class="normal">],<sp/>0.0));</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/>tf2::Quaternion<sp/>q_map_odom;</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/>q_map_odom.setRPY(0,<sp/>0,<sp/>ros_param_position[</highlight><highlight class="stringliteral">&quot;yaw&quot;</highlight><highlight class="normal">]);</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/>homogtrans_map_odom.setRotation(q_map_odom);</highlight></codeline>
<codeline lineno="198"><highlight class="normal"></highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="classed_1_1Plugin_1a3c2f7b0513527158853dbc04ffcc8238" kindref="member" external="/home/docker/ros/noetic/system/build/docs/ed/tags">tf_buffer_</ref>-&gt;canTransform(<ref refid="classLocalizationPlugin_1a5f64585d0b1622f3335900dc4991d518" kindref="member">odom_frame_id_</ref>,<sp/><ref refid="classLocalizationPlugin_1af331d2a967d487d8f0d7814db64c3894" kindref="member">base_link_frame_id_</ref>,<sp/>ros::Time(0),<sp/>ros::Duration(1)))</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cpp/string/basic_string" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">std::string</ref><sp/>msg<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;No<sp/>transform<sp/>between<sp/>odom<sp/>and<sp/>base_link&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ROS_ERROR_STREAM_NAMED(</highlight><highlight class="stringliteral">&quot;Localization&quot;</highlight><highlight class="normal">,<sp/>msg);</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/><ref refid="classConfigurationException" kindref="compound">ConfigurationException</ref>(msg);</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="205"><highlight class="normal"></highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>geometry_msgs::TransformStamped<sp/>ts<sp/>=<sp/><ref refid="classed_1_1Plugin_1a3c2f7b0513527158853dbc04ffcc8238" kindref="member" external="/home/docker/ros/noetic/system/build/docs/ed/tags">tf_buffer_</ref>-&gt;lookupTransform(<ref refid="classLocalizationPlugin_1a5f64585d0b1622f3335900dc4991d518" kindref="member">odom_frame_id_</ref>,<sp/><ref refid="classLocalizationPlugin_1af331d2a967d487d8f0d7814db64c3894" kindref="member">base_link_frame_id_</ref>,<sp/>ros::Time(0));</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tf2::Stamped&lt;tf2::Transform&gt;<sp/>tf_odom_base_link;</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tf2::convert(ts,<sp/>tf_odom_base_link);</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Calculate<sp/>base<sp/>link<sp/>position<sp/>in<sp/>map<sp/>frame</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tf2::Transform<sp/>tf_map_base_link<sp/>=<sp/>homogtrans_map_odom<sp/>*<sp/>tf_odom_base_link;</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tf2::Vector3<sp/>pos_map_baselink<sp/>=<sp/>tf_map_base_link.getOrigin();<sp/></highlight><highlight class="comment">//<sp/>Returns<sp/>a<sp/>vector</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tf2::Quaternion<sp/>rotation_map_baselink<sp/>=<sp/>tf_map_base_link.getRotation();<sp/></highlight><highlight class="comment">//<sp/>Returns<sp/>a<sp/>quaternion</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="215"><highlight class="normal"></highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classgeo_1_1Transform2T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Transform2d</ref><sp/>result;</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result.<ref refid="classgeo_1_1Transform2T_1aed7a26b999f43c9186efe8991823bf13" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">t</ref>.<ref refid="classgeo_1_1Vec2T_1a476c2f7cacbf6b233746ab18f2a87c54" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">x</ref><sp/>=<sp/>pos_map_baselink.x();</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result.<ref refid="classgeo_1_1Transform2T_1aed7a26b999f43c9186efe8991823bf13" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">t</ref>.<ref refid="classgeo_1_1Vec2T_1a506e3148ad901feea9e7658a4d35fe8b" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">y</ref><sp/>=<sp/>pos_map_baselink.y();</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result.<ref refid="classgeo_1_1Transform2T_1aa36300150db55b0e8032e3e86ab549b7" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">setRotation</ref>(rotation_map_baselink.getAngle());</highlight></codeline>
<codeline lineno="220"><highlight class="normal"></highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ROS_DEBUG_STREAM_NAMED(</highlight><highlight class="stringliteral">&quot;Localization&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Initial<sp/>pose<sp/>from<sp/>parameter<sp/>server:<sp/>[&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result.<ref refid="classgeo_1_1Transform2T_1aed7a26b999f43c9186efe8991823bf13" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">t</ref>.<ref refid="classgeo_1_1Vec2T_1a476c2f7cacbf6b233746ab18f2a87c54" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">x</ref><sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;,<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>result.<ref refid="classgeo_1_1Transform2T_1aed7a26b999f43c9186efe8991823bf13" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">t</ref>.<ref refid="classgeo_1_1Vec2T_1a506e3148ad901feea9e7658a4d35fe8b" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">y</ref><sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;],<sp/>yaw:&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>result.<ref refid="classgeo_1_1Transform2T_1afe0ff43534bc176195bd3e70887fba95" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">rotation</ref>()</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>);</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">catch</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>tf2::TransformException&amp;<sp/>ex)</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cpp/string/basic_string" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">std::string</ref><sp/>msg<sp/>=<sp/><ref refid="cpp/string/basic_string" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">std::string</ref>(ex.what());</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ROS_ERROR_STREAM_NAMED(</highlight><highlight class="stringliteral">&quot;Localization&quot;</highlight><highlight class="normal">,<sp/>msg);</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/><ref refid="classConfigurationException" kindref="compound">ConfigurationException</ref>(msg);</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="232"><highlight class="normal">}</highlight></codeline>
<codeline lineno="233"><highlight class="normal"></highlight></codeline>
<codeline lineno="234"><highlight class="normal"></highlight><highlight class="comment">//<sp/>----------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="235"><highlight class="normal"></highlight></codeline>
<codeline lineno="236" refid="classLocalizationPlugin_1adf4151431acb06c1167fb1894d4d55bd" refkind="member"><highlight class="normal"><ref refid="classgeo_1_1Transform2T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Transform2</ref><sp/><ref refid="classLocalizationPlugin_1adf4151431acb06c1167fb1894d4d55bd" kindref="member">LocalizationPlugin::tryGetInitialPoseFromConfig</ref>(<ref refid="classtue_1_1config_1_1ReaderWriter" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">tue::Configuration</ref>&amp;<sp/>config)</highlight></codeline>
<codeline lineno="237"><highlight class="normal">{</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>x,<sp/>y,<sp/>yaw;</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>.<ref refid="classtue_1_1config_1_1ReaderWriter_1afad170974e5aaf82a3489ae23365f875" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">readGroup</ref>(</highlight><highlight class="stringliteral">&quot;initial_pose&quot;</highlight><highlight class="normal">,<sp/><ref refid="namespacetue_1_1config_1a1ad7ac2e22b2d2ecdbdab22fea6f8eeba4a665c52d925f41ad398fcca3a82f5cb" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">tue::config::OPTIONAL</ref>))</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>.<ref refid="classtue_1_1config_1_1ReaderWriter_1a6b49f39a05ada8016feb604bb2f801e8" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">value</ref>(</highlight><highlight class="stringliteral">&quot;x&quot;</highlight><highlight class="normal">,<sp/>x);</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>.<ref refid="classtue_1_1config_1_1ReaderWriter_1a6b49f39a05ada8016feb604bb2f801e8" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">value</ref>(</highlight><highlight class="stringliteral">&quot;y&quot;</highlight><highlight class="normal">,<sp/>y);</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>.<ref refid="classtue_1_1config_1_1ReaderWriter_1a6b49f39a05ada8016feb604bb2f801e8" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">value</ref>(</highlight><highlight class="stringliteral">&quot;rz&quot;</highlight><highlight class="normal">,<sp/>yaw);</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sdf__gtest_8cpp_1a82a0ab7303cc394c32a028c9a6b2823c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">config</ref>.<ref refid="classtue_1_1config_1_1ReaderWriter_1aa2955d31c9ea83ef3e7949b49fe4c051" kindref="member" external="/home/docker/ros/noetic/system/build/docs/tue_config/tags">endGroup</ref>();</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cpp/string/basic_string" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">std::string</ref><sp/>message<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Initial<sp/>pose<sp/>not<sp/>present<sp/>in<sp/>config&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ROS_WARN_STREAM_NAMED(</highlight><highlight class="stringliteral">&quot;Localization&quot;</highlight><highlight class="normal">,<sp/>message);</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/><ref refid="classConfigurationException" kindref="compound">ConfigurationException</ref>(message);</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="252"><highlight class="normal"></highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classgeo_1_1Transform2T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Transform2d</ref><sp/>result(x,<sp/>y,<sp/>yaw);</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="255"><highlight class="normal">}</highlight></codeline>
<codeline lineno="256"><highlight class="normal"></highlight></codeline>
<codeline lineno="257"><highlight class="normal"></highlight><highlight class="comment">//<sp/>----------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="258"><highlight class="normal"></highlight></codeline>
<codeline lineno="259" refid="classLocalizationPlugin_1adcd269e3f3379035f1d23c25a4cb69a1" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classLocalizationPlugin_1adcd269e3f3379035f1d23c25a4cb69a1" kindref="member">LocalizationPlugin::initialize</ref>()</highlight></codeline>
<codeline lineno="260"><highlight class="normal">{</highlight></codeline>
<codeline lineno="261"><highlight class="normal">}</highlight></codeline>
<codeline lineno="262"><highlight class="normal"></highlight></codeline>
<codeline lineno="263"><highlight class="normal"></highlight><highlight class="comment">//<sp/>----------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="264"><highlight class="normal"></highlight></codeline>
<codeline lineno="265" refid="classLocalizationPlugin_1a8b40520b9e66aff3a151c8abc4aa967e" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classLocalizationPlugin_1a8b40520b9e66aff3a151c8abc4aa967e" kindref="member">LocalizationPlugin::process</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classed_1_1WorldModel_1_1EntityIterator" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/ed/tags">ed::WorldModel</ref>&amp;<sp/>world,<sp/><ref refid="classed_1_1UpdateRequest" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/ed/tags">ed::UpdateRequest</ref>&amp;<sp/>req)</highlight></codeline>
<codeline lineno="266"><highlight class="normal">{</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1a91c5601fb71058823b4ceef83ef9da9c" kindref="member">initial_pose_msg_</ref>.reset();</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1ab318464d02d0c0c8c05543971f7029c5" kindref="member">cb_queue_</ref>.callAvailable();</highlight></codeline>
<codeline lineno="269"><highlight class="normal"></highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classLocalizationPlugin_1a91c5601fb71058823b4ceef83ef9da9c" kindref="member">initial_pose_msg_</ref>)</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Set<sp/>initial<sp/>pose</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classgeo_1_1Transform3T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Pose3D</ref><sp/>pose;</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacegeo_1a91908a364354e736f2701a214ec9ded6" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::convert</ref>(<ref refid="classLocalizationPlugin_1a91c5601fb71058823b4ceef83ef9da9c" kindref="member">initial_pose_msg_</ref>-&gt;pose.pose,<sp/>pose);</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1a648acd040eb409b43f7e561426166894" kindref="member">initParticleFilterUniform</ref>(pose.<ref refid="classgeo_1_1Transform3T_1a57186a12e9cc570e7cdfbf03c5b1fab2" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">projectTo2d</ref>());</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="277"><highlight class="normal"></highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(!<ref refid="classLocalizationPlugin_1a9f88c5b03be3117b968076569627a9c5" kindref="member">scan_buffer_</ref>.<ref refid="cpp/container/queue/empty" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">empty</ref>())</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="localization__plugin_8h_1a54196d04460fa3148590062902e500f0" kindref="member">TransformStatus</ref><sp/>status<sp/>=<sp/><ref refid="classLocalizationPlugin_1ab3939214d6279115570dd7ceb4ff5b10" kindref="member">update</ref>(<ref refid="classLocalizationPlugin_1a9f88c5b03be3117b968076569627a9c5" kindref="member">scan_buffer_</ref>.<ref refid="cpp/container/queue/front" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">front</ref>(),<sp/>world,<sp/><ref refid="namespacereset_1ad13c6ac93e71952bf2f3b8c9aefcaf5d" kindref="member" external="/home/docker/ros/noetic/system/build/docs/ed/tags">req</ref>);</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(status<sp/>==<sp/><ref refid="localization__plugin_8h_1a54196d04460fa3148590062902e500f0a2bc49ec37d6a5715dd23e85f1ff5bb59" kindref="member">OK</ref><sp/>||<sp/>status<sp/>==<sp/><ref refid="localization__plugin_8h_1a54196d04460fa3148590062902e500f0ae892996e5aead6e5b9491a3829debf7b" kindref="member">TOO_OLD</ref><sp/>||<sp/>status<sp/>==<sp/><ref refid="localization__plugin_8h_1a54196d04460fa3148590062902e500f0a8216aa4b3a817cdf8c15ed32aa946e83" kindref="member">UNKNOWN_ERROR</ref>)</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1a9f88c5b03be3117b968076569627a9c5" kindref="member">scan_buffer_</ref>.<ref refid="cpp/container/queue/pop" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">pop</ref>();</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="286"><highlight class="normal">}</highlight></codeline>
<codeline lineno="287"><highlight class="normal"></highlight></codeline>
<codeline lineno="288"><highlight class="normal"></highlight><highlight class="comment">//<sp/>----------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="289"><highlight class="normal"></highlight></codeline>
<codeline lineno="290" refid="classLocalizationPlugin_1ab3939214d6279115570dd7ceb4ff5b10" refkind="member"><highlight class="normal"><ref refid="localization__plugin_8h_1a54196d04460fa3148590062902e500f0" kindref="member">TransformStatus</ref><sp/><ref refid="classLocalizationPlugin_1ab3939214d6279115570dd7ceb4ff5b10" kindref="member">LocalizationPlugin::update</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>sensor_msgs::LaserScanConstPtr&amp;<sp/>scan,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classed_1_1WorldModel_1_1EntityIterator" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/ed/tags">ed::WorldModel</ref>&amp;<sp/>world,<sp/><ref refid="classed_1_1UpdateRequest" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/ed/tags">ed::UpdateRequest</ref>&amp;<sp/>req)</highlight></codeline>
<codeline lineno="291"><highlight class="normal">{</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>Get<sp/>transformation<sp/>from<sp/>base_link<sp/>to<sp/>laser_frame</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="classLocalizationPlugin_1a33fcf663096315faec051b7119a8f091" kindref="member">laser_offset_initialized_</ref>)</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="localization__plugin_8h_1a54196d04460fa3148590062902e500f0" kindref="member">TransformStatus</ref><sp/>ts<sp/>=<sp/><ref refid="classLocalizationPlugin_1aa7936ed6d50f8f20f6f19688fa2cd2e5" kindref="member">initLaserOffset</ref>(scan-&gt;header.frame_id,<sp/>scan-&gt;header.stamp);</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ts<sp/>!=<sp/><ref refid="localization__plugin_8h_1a54196d04460fa3148590062902e500f0a2bc49ec37d6a5715dd23e85f1ff5bb59" kindref="member">OK</ref>)</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ts;</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="299"><highlight class="normal"></highlight></codeline>
<codeline lineno="300"><highlight class="normal"></highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Check<sp/>if<sp/>particle<sp/>filter<sp/>is<sp/>initialized</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classLocalizationPlugin_1a36cfa1be4e485cc98a50bb8df493f9af" kindref="member">particle_filter_</ref>.<ref refid="classParticleFilter_1a8be684d1455f22a4a46149a222ccec8e" kindref="member">samples</ref>().<ref refid="cpp/container/vector/empty" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">empty</ref>())</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ROS_ERROR_NAMED(</highlight><highlight class="stringliteral">&quot;Localization&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;(update)<sp/>Empty<sp/>particle<sp/>filter&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="localization__plugin_8h_1a54196d04460fa3148590062902e500f0a8216aa4b3a817cdf8c15ed32aa946e83" kindref="member">UNKNOWN_ERROR</ref>;</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="307"><highlight class="normal"></highlight></codeline>
<codeline lineno="308"><highlight class="normal"></highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Calculate<sp/>delta<sp/>movement<sp/>based<sp/>on<sp/>odom<sp/>(fetched<sp/>from<sp/>TF)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classgeo_1_1Transform3T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Pose3D</ref><sp/>odom_to_base_link;</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classgeo_1_1Transform2T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Transform2</ref><sp/>movement;</highlight></codeline>
<codeline lineno="312"><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/>tf2::Stamped&lt;tf2::Transform&gt;<sp/>odom_to_base_link_tf;</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="localization__plugin_8h_1a54196d04460fa3148590062902e500f0" kindref="member">TransformStatus</ref><sp/>ts<sp/>=<sp/><ref refid="classLocalizationPlugin_1a86b8b96d8083d92f319b8a1494a0179a" kindref="member">transform</ref>(<ref refid="classLocalizationPlugin_1a5f64585d0b1622f3335900dc4991d518" kindref="member">odom_frame_id_</ref>,<sp/><ref refid="classLocalizationPlugin_1af331d2a967d487d8f0d7814db64c3894" kindref="member">base_link_frame_id_</ref>,<sp/>scan-&gt;header.stamp,<sp/>odom_to_base_link_tf);</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ts<sp/>!=<sp/><ref refid="localization__plugin_8h_1a54196d04460fa3148590062902e500f0a2bc49ec37d6a5715dd23e85f1ff5bb59" kindref="member">OK</ref>)</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ts;</highlight></codeline>
<codeline lineno="317"><highlight class="normal"></highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespacegeo_1a91908a364354e736f2701a214ec9ded6" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::convert</ref>(odom_to_base_link_tf,<sp/>odom_to_base_link);</highlight></codeline>
<codeline lineno="319"><highlight class="normal"></highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classLocalizationPlugin_1ae075198c6b7b9caddea8a04a324542c8" kindref="member">have_previous_odom_pose_</ref>)</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Get<sp/>displacement<sp/>and<sp/>project<sp/>to<sp/>2D</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>movement<sp/>=<sp/>(<ref refid="classLocalizationPlugin_1a66273bd3858e4e623cbafa97ac173aba" kindref="member">previous_odom_pose_</ref>.<ref refid="classgeo_1_1Transform3T_1a4daef91f27c4a336e18c388638e27fa9" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">inverse</ref>()<sp/>*<sp/>odom_to_base_link).projectTo2d();</highlight></codeline>
<codeline lineno="324"><highlight class="normal"></highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1af8d0e14460a70eed3d225cbbac4d9801" kindref="member">update_</ref><sp/>=<sp/>std::abs(movement.<ref refid="classgeo_1_1Transform2T_1aed7a26b999f43c9186efe8991823bf13" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">t</ref>.<ref refid="classgeo_1_1Vec2T_1a476c2f7cacbf6b233746ab18f2a87c54" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">x</ref>)<sp/>&gt;=<sp/><ref refid="classLocalizationPlugin_1a8568afa17d7534fb1cfdebea84fe8740" kindref="member">update_min_d_</ref><sp/>||<sp/>std::abs(movement.<ref refid="classgeo_1_1Transform2T_1aed7a26b999f43c9186efe8991823bf13" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">t</ref>.<ref refid="classgeo_1_1Vec2T_1a506e3148ad901feea9e7658a4d35fe8b" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">y</ref>)<sp/>&gt;=<sp/><ref refid="classLocalizationPlugin_1a8568afa17d7534fb1cfdebea84fe8740" kindref="member">update_min_d_</ref><sp/>||<sp/>std::abs(movement.<ref refid="classgeo_1_1Transform2T_1afe0ff43534bc176195bd3e70887fba95" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">rotation</ref>())<sp/>&gt;=<sp/><ref refid="classLocalizationPlugin_1ab8b3e51465560c525cc37d006027d530" kindref="member">update_min_a_</ref>;</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="327"><highlight class="normal"></highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>force_publication<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="classLocalizationPlugin_1ae075198c6b7b9caddea8a04a324542c8" kindref="member">have_previous_odom_pose_</ref>)</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1a66273bd3858e4e623cbafa97ac173aba" kindref="member">previous_odom_pose_</ref><sp/>=<sp/>odom_to_base_link;</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1ae075198c6b7b9caddea8a04a324542c8" kindref="member">have_previous_odom_pose_</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1af8d0e14460a70eed3d225cbbac4d9801" kindref="member">update_</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>force_publication<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classLocalizationPlugin_1ae075198c6b7b9caddea8a04a324542c8" kindref="member">have_previous_odom_pose_</ref><sp/>&amp;&amp;<sp/><ref refid="classLocalizationPlugin_1af8d0e14460a70eed3d225cbbac4d9801" kindref="member">update_</ref>)</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Update<sp/>motion</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1a5a57f0fa74809ce2611fcd22bf1075a5" kindref="member">odom_model_</ref>.<ref refid="classOdomModel_1aae048baa8fcb588e69a5b800d7e8af6e" kindref="member">updatePoses</ref>(movement,<sp/><ref refid="classLocalizationPlugin_1a36cfa1be4e485cc98a50bb8df493f9af" kindref="member">particle_filter_</ref>);</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="341"><highlight class="normal"></highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>resampled<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classLocalizationPlugin_1af8d0e14460a70eed3d225cbbac4d9801" kindref="member">update_</ref>)</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ROS_DEBUG_NAMED(</highlight><highlight class="stringliteral">&quot;Localization&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Updating<sp/>laser&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Update<sp/>sensor</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1aba89e1770526c9705f2f8f07c25118dc" kindref="member">laser_model_</ref>.<ref refid="classLaserModel_1a3ff055c6fbb0ffd0c9f9e4012a99747a" kindref="member">updateWeights</ref>(world,<sp/>*scan,<sp/><ref refid="classLocalizationPlugin_1a36cfa1be4e485cc98a50bb8df493f9af" kindref="member">particle_filter_</ref>);</highlight></codeline>
<codeline lineno="348"><highlight class="normal"></highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1a66273bd3858e4e623cbafa97ac173aba" kindref="member">previous_odom_pose_</ref><sp/>=<sp/>odom_to_base_link;</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1ae075198c6b7b9caddea8a04a324542c8" kindref="member">have_previous_odom_pose_</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="351"><highlight class="normal"></highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1af8d0e14460a70eed3d225cbbac4d9801" kindref="member">update_</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="353"><highlight class="normal"></highlight></codeline>
<codeline lineno="354"><highlight class="normal"></highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>(Re)sample</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>resampled<sp/>=<sp/><ref refid="classLocalizationPlugin_1a80b745458757d5cebf3783f0d53d9b6d" kindref="member">resample</ref>(world);</highlight></codeline>
<codeline lineno="357"><highlight class="normal"></highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Publish<sp/>particles</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1a44ad57dff21782c445ca444881f40c6e" kindref="member">publishParticles</ref>(scan-&gt;header.stamp);</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="361"><highlight class="normal"></highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Update<sp/>map-odom</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(resampled<sp/>||<sp/>force_publication)</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1a91c4507a9466a587df8e417230514998" kindref="member">updateMapOdom</ref>(odom_to_base_link);</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="367"><highlight class="normal"></highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Publish<sp/>result</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classLocalizationPlugin_1a6dde8647bde3baaaec712b2ea6d93c9f" kindref="member">latest_map_odom_valid_</ref>)</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1ac3ba8afe8d1409d9948a678248a62d2d" kindref="member">publishMapOdom</ref>(scan-&gt;header.stamp);</highlight></codeline>
<codeline lineno="372"><highlight class="normal"></highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>This<sp/>should<sp/>be<sp/>executed<sp/>allways.<sp/>map_odom<sp/>*<sp/>odom_base_link</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="classLocalizationPlugin_1a662b8389b5f676d95a33e2f998e8a517" kindref="member">robot_name_</ref>.<ref refid="cpp/string/basic_string/empty" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">empty</ref>())</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacereset_1ad13c6ac93e71952bf2f3b8c9aefcaf5d" kindref="member" external="/home/docker/ros/noetic/system/build/docs/ed/tags">req</ref>.setPose(<ref refid="classLocalizationPlugin_1a662b8389b5f676d95a33e2f998e8a517" kindref="member">robot_name_</ref>,<sp/><ref refid="classLocalizationPlugin_1a33ba6850e565de9231fea1704fa36cec" kindref="member">latest_map_odom_</ref><sp/>*<sp/><ref refid="classLocalizationPlugin_1a66273bd3858e4e623cbafa97ac173aba" kindref="member">previous_odom_pose_</ref>);</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="377"><highlight class="normal"></highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Visualization</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classLocalizationPlugin_1a75ad0dd7d5715c85f1a293287fedaa05" kindref="member">visualize_</ref>)</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1aab85299fc7e0f8430a4778a75d55c2e5" kindref="member">visualize</ref>();</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cv::destroyAllWindows();</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="387"><highlight class="normal"></highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="localization__plugin_8h_1a54196d04460fa3148590062902e500f0a2bc49ec37d6a5715dd23e85f1ff5bb59" kindref="member">OK</ref>;</highlight></codeline>
<codeline lineno="389"><highlight class="normal">}</highlight></codeline>
<codeline lineno="390"><highlight class="normal"></highlight></codeline>
<codeline lineno="391"><highlight class="normal"></highlight><highlight class="comment">//<sp/>----------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="392"><highlight class="normal"></highlight></codeline>
<codeline lineno="393" refid="classLocalizationPlugin_1aa7936ed6d50f8f20f6f19688fa2cd2e5" refkind="member"><highlight class="normal"><ref refid="localization__plugin_8h_1a54196d04460fa3148590062902e500f0" kindref="member">TransformStatus</ref><sp/><ref refid="classLocalizationPlugin_1aa7936ed6d50f8f20f6f19688fa2cd2e5" kindref="member">LocalizationPlugin::initLaserOffset</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="cpp/string/basic_string" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">std::string</ref>&amp;<sp/>frame_id,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>ros::Time&amp;<sp/>stamp)</highlight></codeline>
<codeline lineno="394"><highlight class="normal">{</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/>tf2::Stamped&lt;tf2::Transform&gt;<sp/>p_laser;</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="localization__plugin_8h_1a54196d04460fa3148590062902e500f0" kindref="member">TransformStatus</ref><sp/>ts<sp/>=<sp/><ref refid="classLocalizationPlugin_1a86b8b96d8083d92f319b8a1494a0179a" kindref="member">transform</ref>(<ref refid="classLocalizationPlugin_1af331d2a967d487d8f0d7814db64c3894" kindref="member">base_link_frame_id_</ref>,<sp/>frame_id,<sp/>stamp,<sp/>p_laser);</highlight></codeline>
<codeline lineno="397"><highlight class="normal"></highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ts<sp/>!=<sp/><ref refid="localization__plugin_8h_1a54196d04460fa3148590062902e500f0a2bc49ec37d6a5715dd23e85f1ff5bb59" kindref="member">OK</ref>)</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ts;</highlight></codeline>
<codeline lineno="400"><highlight class="normal"></highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classgeo_1_1Transform2T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Transform2</ref><sp/>offset(<ref refid="classgeo_1_1Mat2T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Mat2</ref>(p_laser.getBasis()[0][0],<sp/>p_laser.getBasis()[0][1],</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p_laser.getBasis()[1][0],<sp/>p_laser.getBasis()[1][1]),</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classgeo_1_1Vec2T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Vec2</ref>(p_laser.getOrigin().getX(),<sp/>p_laser.getOrigin().getY()));</highlight></codeline>
<codeline lineno="404"><highlight class="normal"></highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>upside_down<sp/>=<sp/>p_laser.getBasis()[2][2]<sp/>&lt;<sp/>0;</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(upside_down)</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offset.<ref refid="classgeo_1_1Transform2T_1ace6ce78db401a84c1dfbe0ec83f4dee5" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">R</ref>.<ref refid="classgeo_1_1Mat2T_1aa40ad35798911b17e25e54688d045800" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">yx</ref><sp/>=<sp/>-offset.<ref refid="classgeo_1_1Transform2T_1ace6ce78db401a84c1dfbe0ec83f4dee5" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">R</ref>.<ref refid="classgeo_1_1Mat2T_1aa40ad35798911b17e25e54688d045800" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">yx</ref>;</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offset.<ref refid="classgeo_1_1Transform2T_1ace6ce78db401a84c1dfbe0ec83f4dee5" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">R</ref>.<ref refid="classgeo_1_1Mat2T_1ad7491ca15dfbc8d7218fe9b88c6e7964" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">yy</ref><sp/>=<sp/>-offset.<ref refid="classgeo_1_1Transform2T_1ace6ce78db401a84c1dfbe0ec83f4dee5" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">R</ref>.<ref refid="classgeo_1_1Mat2T_1ad7491ca15dfbc8d7218fe9b88c6e7964" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">yy</ref>;</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="411"><highlight class="normal"></highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>laser_height<sp/>=<sp/>p_laser.getOrigin().getZ();</highlight></codeline>
<codeline lineno="413"><highlight class="normal"></highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1aba89e1770526c9705f2f8f07c25118dc" kindref="member">laser_model_</ref>.<ref refid="classLaserModel_1adcc37222e0c0da03457df187c61be3a9" kindref="member">setLaserOffset</ref>(offset,<sp/>laser_height,<sp/>upside_down);</highlight></codeline>
<codeline lineno="415"><highlight class="normal"></highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1a33fcf663096315faec051b7119a8f091" kindref="member">laser_offset_initialized_</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="417"><highlight class="normal"></highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="localization__plugin_8h_1a54196d04460fa3148590062902e500f0a2bc49ec37d6a5715dd23e85f1ff5bb59" kindref="member">OK</ref>;</highlight></codeline>
<codeline lineno="419"><highlight class="normal">}</highlight></codeline>
<codeline lineno="420"><highlight class="normal"></highlight></codeline>
<codeline lineno="421"><highlight class="normal"></highlight><highlight class="comment">//<sp/>----------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="422"><highlight class="normal"></highlight></codeline>
<codeline lineno="423" refid="classLocalizationPlugin_1a648acd040eb409b43f7e561426166894" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classLocalizationPlugin_1a648acd040eb409b43f7e561426166894" kindref="member">LocalizationPlugin::initParticleFilterUniform</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classgeo_1_1Transform2T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Transform2</ref>&amp;<sp/>pose)</highlight></codeline>
<codeline lineno="424"><highlight class="normal">{</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classgeo_1_1Vec2T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Vec2</ref>&amp;<sp/>p<sp/>=<sp/>pose.<ref refid="classgeo_1_1Transform2T_1a490ce2dc5242d30c15e24c4f2357de38" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">getOrigin</ref>();</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>yaw<sp/>=<sp/>pose.<ref refid="classgeo_1_1Transform2T_1afe0ff43534bc176195bd3e70887fba95" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">rotation</ref>();</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1a36cfa1be4e485cc98a50bb8df493f9af" kindref="member">particle_filter_</ref>.<ref refid="classParticleFilter_1a4284df30b6029aea71dbabb7385898a5" kindref="member">initUniform</ref>(p<sp/>-<sp/><ref refid="classgeo_1_1Vec2T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Vec2</ref>(0.3,<sp/>0.3),<sp/>p<sp/>+<sp/><ref refid="classgeo_1_1Vec2T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Vec2</ref>(0.3,<sp/>0.3),<sp/>yaw<sp/>-<sp/>0.3,<sp/>yaw<sp/>+<sp/>0.3);</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1ae075198c6b7b9caddea8a04a324542c8" kindref="member">have_previous_odom_pose_</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1af9fb8135b06da9609c9946108bb8fd60" kindref="member">resample_count_</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="430"><highlight class="normal">}</highlight></codeline>
<codeline lineno="431"><highlight class="normal"></highlight></codeline>
<codeline lineno="432"><highlight class="normal"></highlight><highlight class="comment">//<sp/>----------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="433"><highlight class="normal"></highlight></codeline>
<codeline lineno="434" refid="classLocalizationPlugin_1a80b745458757d5cebf3783f0d53d9b6d" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classLocalizationPlugin_1a80b745458757d5cebf3783f0d53d9b6d" kindref="member">LocalizationPlugin::resample</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classed_1_1WorldModel_1_1EntityIterator" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/ed/tags">ed::WorldModel</ref>&amp;<sp/>world)</highlight></codeline>
<codeline lineno="435"><highlight class="normal">{</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(++<ref refid="classLocalizationPlugin_1af9fb8135b06da9609c9946108bb8fd60" kindref="member">resample_count_</ref><sp/>%<sp/><ref refid="classLocalizationPlugin_1a8a765de871047be859057021f81223d2" kindref="member">resample_interval_</ref>)</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="438"><highlight class="normal"></highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/>ROS_DEBUG_NAMED(</highlight><highlight class="stringliteral">&quot;Localization&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;resample<sp/>particle<sp/>filter&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="cpp/utility/functional/function" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">std::function</ref>&lt;void()&gt;<sp/>update_map_size_func<sp/>=<sp/><ref refid="cpp/utility/functional/bind" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">std::bind</ref>(&amp;<ref refid="classLocalizationPlugin_1ad53bf0ce4d03282a57b6948cffffcb54" kindref="member">LocalizationPlugin::updateMapSize</ref>,<sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/><ref refid="cpp/utility/functional/ref" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">std::ref</ref>(world));</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="cpp/utility/functional/function" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">std::function</ref>&lt;<ref refid="namespacegeo_1a1289d44a246f4b273f9d37208648754c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Transform2</ref>()&gt;<sp/>gen_random_pose_func<sp/>=<sp/><ref refid="cpp/utility/functional/bind" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">std::bind</ref>(&amp;<ref refid="classLocalizationPlugin_1a1ddfeae99d23f6e5fd79f8b3a30c91f2" kindref="member">LocalizationPlugin::generateRandomPose</ref>,<sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/>update_map_size_func);</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1a36cfa1be4e485cc98a50bb8df493f9af" kindref="member">particle_filter_</ref>.<ref refid="classParticleFilter_1a75295e8300132ed3a6f8a7f9822a6460" kindref="member">resample</ref>(gen_random_pose_func);</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="444"><highlight class="normal">}</highlight></codeline>
<codeline lineno="445"><highlight class="normal"></highlight></codeline>
<codeline lineno="446"><highlight class="normal"></highlight><highlight class="comment">//<sp/>----------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="447"><highlight class="normal"></highlight></codeline>
<codeline lineno="448" refid="classLocalizationPlugin_1a44ad57dff21782c445ca444881f40c6e" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classLocalizationPlugin_1a44ad57dff21782c445ca444881f40c6e" kindref="member">LocalizationPlugin::publishParticles</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>ros::Time<sp/>&amp;stamp)</highlight></codeline>
<codeline lineno="449"><highlight class="normal">{</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/>ROS_DEBUG_NAMED(</highlight><highlight class="stringliteral">&quot;Localization&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Publishing<sp/>particles&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="cpp/container/vector" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">std::vector&lt;Sample&gt;</ref>&amp;<sp/>samples<sp/>=<sp/><ref refid="classLocalizationPlugin_1a36cfa1be4e485cc98a50bb8df493f9af" kindref="member">particle_filter_</ref>.<ref refid="classParticleFilter_1a8be684d1455f22a4a46149a222ccec8e" kindref="member">samples</ref>();</highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/>geometry_msgs::PoseArray<sp/>particles_msg;</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/>particles_msg.poses.<ref refid="cpp/container/vector/resize" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">resize</ref>(samples.<ref refid="cpp/container/vector/size" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">size</ref>());</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>samples.<ref refid="cpp/container/vector/size" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">size</ref>();<sp/>++i)</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classgeo_1_1Transform2T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Transform2</ref>&amp;<sp/>p<sp/>=<sp/>samples[i].pose;</highlight></codeline>
<codeline lineno="457"><highlight class="normal"></highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classgeo_1_1Transform3T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Pose3D</ref><sp/>pose_3d<sp/>=<sp/>p.<ref refid="classgeo_1_1Transform2T_1ac00441a7d9191c7f9717f87003309dfb" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">projectTo3d</ref>();</highlight></codeline>
<codeline lineno="459"><highlight class="normal"></highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacegeo_1a91908a364354e736f2701a214ec9ded6" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::convert</ref>(pose_3d,<sp/>particles_msg.poses[i]);</highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="462"><highlight class="normal"></highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/>particles_msg.header.frame_id<sp/>=<sp/><ref refid="classLocalizationPlugin_1a582b4df5eff61a67233084ebe7905286" kindref="member">map_frame_id_</ref>;</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/>particles_msg.header.stamp<sp/>=<sp/>stamp;</highlight></codeline>
<codeline lineno="465"><highlight class="normal"></highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1afb3da7dc518a25c59eca0ab9092d2234" kindref="member">pub_particles_</ref>.publish(particles_msg);</highlight></codeline>
<codeline lineno="467"><highlight class="normal">}</highlight></codeline>
<codeline lineno="468"><highlight class="normal"></highlight></codeline>
<codeline lineno="469"><highlight class="normal"></highlight><highlight class="comment">//<sp/>----------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="470"><highlight class="normal"></highlight></codeline>
<codeline lineno="471" refid="classLocalizationPlugin_1a91c4507a9466a587df8e417230514998" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classLocalizationPlugin_1a91c4507a9466a587df8e417230514998" kindref="member">LocalizationPlugin::updateMapOdom</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classgeo_1_1Transform3T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Pose3D</ref>&amp;<sp/>odom_to_base_link)</highlight></codeline>
<codeline lineno="472"><highlight class="normal">{</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/>ROS_DEBUG_NAMED(</highlight><highlight class="stringliteral">&quot;Localization&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Updating<sp/>map_odom&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Get<sp/>the<sp/>best<sp/>pose<sp/>(2D)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classgeo_1_1Transform2T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Transform2</ref><sp/>mean_pose<sp/>=<sp/><ref refid="classLocalizationPlugin_1a36cfa1be4e485cc98a50bb8df493f9af" kindref="member">particle_filter_</ref>.<ref refid="classParticleFilter_1a55be392b2a262cb05ae6caab56199557" kindref="member">calculateMeanPose</ref>();</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/>ROS_DEBUG_STREAM(</highlight><highlight class="stringliteral">&quot;mean_pose:<sp/>x:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>mean_pose.<ref refid="classgeo_1_1Transform2T_1aed7a26b999f43c9186efe8991823bf13" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">t</ref>.<ref refid="classgeo_1_1Vec2T_1a476c2f7cacbf6b233746ab18f2a87c54" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">x</ref><sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;,<sp/>y:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>mean_pose.<ref refid="classgeo_1_1Transform2T_1aed7a26b999f43c9186efe8991823bf13" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">t</ref>.<ref refid="classgeo_1_1Vec2T_1a506e3148ad901feea9e7658a4d35fe8b" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">y</ref><sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;,<sp/>yaw:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>mean_pose.<ref refid="classgeo_1_1Transform2T_1afe0ff43534bc176195bd3e70887fba95" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">rotation</ref>());</highlight></codeline>
<codeline lineno="477"><highlight class="normal"></highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Convert<sp/>best<sp/>pose<sp/>to<sp/>3D</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classgeo_1_1Transform3T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Pose3D</ref><sp/>map_to_base_link;</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/>map_to_base_link<sp/>=<sp/>mean_pose.<ref refid="classgeo_1_1Transform2T_1ac00441a7d9191c7f9717f87003309dfb" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">projectTo3d</ref>();</highlight></codeline>
<codeline lineno="481"><highlight class="normal"></highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1a33ba6850e565de9231fea1704fa36cec" kindref="member">latest_map_odom_</ref><sp/>=<sp/>map_to_base_link<sp/>*<sp/>odom_to_base_link.<ref refid="classgeo_1_1Transform3T_1a4daef91f27c4a336e18c388638e27fa9" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">inverse</ref>();</highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1a6dde8647bde3baaaec712b2ea6d93c9f" kindref="member">latest_map_odom_valid_</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="484"><highlight class="normal">}</highlight></codeline>
<codeline lineno="485"><highlight class="normal"></highlight></codeline>
<codeline lineno="486"><highlight class="normal"></highlight><highlight class="comment">//<sp/>----------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="487"><highlight class="normal"></highlight></codeline>
<codeline lineno="488" refid="classLocalizationPlugin_1ac3ba8afe8d1409d9948a678248a62d2d" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classLocalizationPlugin_1ac3ba8afe8d1409d9948a678248a62d2d" kindref="member">LocalizationPlugin::publishMapOdom</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>ros::Time<sp/>&amp;stamp)</highlight></codeline>
<codeline lineno="489"><highlight class="normal">{</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/>ROS_DEBUG_THROTTLE_NAMED(2,<sp/></highlight><highlight class="stringliteral">&quot;Localization&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Publishing<sp/>map_odom&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Convert<sp/>to<sp/>TF<sp/>transform</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/>geometry_msgs::TransformStamped<sp/>latest_map_odom_tf;</highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespacegeo_1a91908a364354e736f2701a214ec9ded6" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::convert</ref>(<ref refid="classLocalizationPlugin_1a33ba6850e565de9231fea1704fa36cec" kindref="member">latest_map_odom_</ref>,<sp/>latest_map_odom_tf.transform);</highlight></codeline>
<codeline lineno="494"><highlight class="normal"></highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Set<sp/>frame<sp/>id&apos;s<sp/>and<sp/>time<sp/>stamp</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/>latest_map_odom_tf.header.frame_id<sp/>=<sp/><ref refid="classLocalizationPlugin_1a582b4df5eff61a67233084ebe7905286" kindref="member">map_frame_id_</ref>;</highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/>latest_map_odom_tf.child_frame_id<sp/>=<sp/><ref refid="classLocalizationPlugin_1a5f64585d0b1622f3335900dc4991d518" kindref="member">odom_frame_id_</ref>;</highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/>latest_map_odom_tf.header.stamp<sp/>=<sp/>stamp<sp/>+<sp/><ref refid="classLocalizationPlugin_1a9cc267422db35c3c5c15c8c1d5c6d24b" kindref="member">transform_tolerance_</ref>;</highlight></codeline>
<codeline lineno="499"><highlight class="normal"></highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Publish<sp/>TF</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1ab3afbf96373364bf73ae34d657bdc8af" kindref="member">tf_broadcaster_</ref>-&gt;sendTransform(latest_map_odom_tf);</highlight></codeline>
<codeline lineno="502"><highlight class="normal">}</highlight></codeline>
<codeline lineno="503"><highlight class="normal"></highlight></codeline>
<codeline lineno="504"><highlight class="normal"></highlight><highlight class="comment">//<sp/>----------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="505"><highlight class="normal"></highlight></codeline>
<codeline lineno="506" refid="classLocalizationPlugin_1a86b8b96d8083d92f319b8a1494a0179a" refkind="member"><highlight class="normal"><ref refid="localization__plugin_8h_1a54196d04460fa3148590062902e500f0" kindref="member">TransformStatus</ref><sp/><ref refid="classLocalizationPlugin_1a86b8b96d8083d92f319b8a1494a0179a" kindref="member">LocalizationPlugin::transform</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="cpp/string/basic_string" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">std::string</ref>&amp;<sp/>target_frame,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="cpp/string/basic_string" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">std::string</ref>&amp;<sp/>source_frame,</highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>ros::Time&amp;<sp/>time,<sp/>tf2::Stamped&lt;tf2::Transform&gt;&amp;<sp/>transform)</highlight></codeline>
<codeline lineno="508"><highlight class="normal">{</highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>geometry_msgs::TransformStamped<sp/>ts<sp/>=<sp/><ref refid="classed_1_1Plugin_1a3c2f7b0513527158853dbc04ffcc8238" kindref="member" external="/home/docker/ros/noetic/system/build/docs/ed/tags">tf_buffer_</ref>-&gt;lookupTransform(target_frame,<sp/>source_frame,<sp/>time);</highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tf2::convert(ts,<sp/><ref refid="classLocalizationPlugin_1a86b8b96d8083d92f319b8a1494a0179a" kindref="member">transform</ref>);</highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="localization__plugin_8h_1a54196d04460fa3148590062902e500f0a2bc49ec37d6a5715dd23e85f1ff5bb59" kindref="member">OK</ref>;</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">catch</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>tf2::ExtrapolationException&amp;<sp/>ex)</highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Now<sp/>we<sp/>have<sp/>to<sp/>check<sp/>if<sp/>the<sp/>error<sp/>was<sp/>an<sp/>interpolation<sp/>or<sp/>extrapolation<sp/>error</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>(i.e.,<sp/>the<sp/>scan<sp/>is<sp/>too<sp/>old<sp/>or<sp/>too<sp/>new,<sp/>respectively)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>geometry_msgs::TransformStamped<sp/>latest_transform<sp/>=<sp/><ref refid="classed_1_1Plugin_1a3c2f7b0513527158853dbc04ffcc8238" kindref="member" external="/home/docker/ros/noetic/system/build/docs/ed/tags">tf_buffer_</ref>-&gt;lookupTransform(target_frame,<sp/>source_frame,<sp/>ros::Time(0));</highlight></codeline>
<codeline lineno="522"><highlight class="normal"></highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classLocalizationPlugin_1a9f88c5b03be3117b968076569627a9c5" kindref="member">scan_buffer_</ref>.<ref refid="cpp/container/queue/front" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">front</ref>()-&gt;header.stamp<sp/>&gt;<sp/>latest_transform.header.stamp)</highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Scan<sp/>is<sp/>too<sp/>new</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="localization__plugin_8h_1a54196d04460fa3148590062902e500f0a600a22805fdf551a415caf8eaf62d477" kindref="member">TOO_RECENT</ref>;</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Otherwise<sp/>it<sp/>has<sp/>to<sp/>be<sp/>too<sp/>old</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="localization__plugin_8h_1a54196d04460fa3148590062902e500f0ae892996e5aead6e5b9491a3829debf7b" kindref="member">TOO_OLD</ref>;</highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">catch</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>tf2::TransformException&amp;<sp/>exc)</highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="localization__plugin_8h_1a54196d04460fa3148590062902e500f0a8216aa4b3a817cdf8c15ed32aa946e83" kindref="member">UNKNOWN_ERROR</ref>;</highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">catch</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>tf2::TransformException&amp;<sp/>ex)</highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="localization__plugin_8h_1a54196d04460fa3148590062902e500f0a8216aa4b3a817cdf8c15ed32aa946e83" kindref="member">UNKNOWN_ERROR</ref>;</highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="543"><highlight class="normal">}</highlight></codeline>
<codeline lineno="544"><highlight class="normal"></highlight></codeline>
<codeline lineno="545"><highlight class="normal"></highlight><highlight class="comment">//<sp/>----------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="546"><highlight class="normal"></highlight></codeline>
<codeline lineno="547" refid="classLocalizationPlugin_1a0906c04c237e5ea3b730a327451b83d1" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classLocalizationPlugin_1a0906c04c237e5ea3b730a327451b83d1" kindref="member">LocalizationPlugin::laserCallback</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>sensor_msgs::LaserScanConstPtr&amp;<sp/>msg)</highlight></codeline>
<codeline lineno="548"><highlight class="normal">{</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1a9f88c5b03be3117b968076569627a9c5" kindref="member">scan_buffer_</ref>.<ref refid="cpp/container/queue/push" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">push</ref>(msg);</highlight></codeline>
<codeline lineno="550"><highlight class="normal">}</highlight></codeline>
<codeline lineno="551"><highlight class="normal"></highlight></codeline>
<codeline lineno="552"><highlight class="normal"></highlight><highlight class="comment">//<sp/>----------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="553"><highlight class="normal"></highlight></codeline>
<codeline lineno="554" refid="classLocalizationPlugin_1a244820f6fb36a80c52d7e17a77ef13b9" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classLocalizationPlugin_1a244820f6fb36a80c52d7e17a77ef13b9" kindref="member">LocalizationPlugin::initialPoseCallback</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>geometry_msgs::PoseWithCovarianceStampedConstPtr&amp;<sp/>msg)</highlight></codeline>
<codeline lineno="555"><highlight class="normal">{</highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1a91c5601fb71058823b4ceef83ef9da9c" kindref="member">initial_pose_msg_</ref><sp/>=<sp/>msg;</highlight></codeline>
<codeline lineno="557"><highlight class="normal">}</highlight></codeline>
<codeline lineno="558"><highlight class="normal"></highlight></codeline>
<codeline lineno="559"><highlight class="normal"></highlight><highlight class="comment">//<sp/>----------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="560"><highlight class="normal"></highlight></codeline>
<codeline lineno="561" refid="classLocalizationPlugin_1a1ddfeae99d23f6e5fd79f8b3a30c91f2" refkind="member"><highlight class="normal"><ref refid="classgeo_1_1Transform2T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Transform2</ref><sp/><ref refid="classLocalizationPlugin_1a1ddfeae99d23f6e5fd79f8b3a30c91f2" kindref="member">LocalizationPlugin::generateRandomPose</ref>(<ref refid="cpp/utility/functional/function" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">std::function</ref>&lt;</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">()&gt;<sp/>update_map_size)</highlight></codeline>
<codeline lineno="562"><highlight class="normal">{</highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/>update_map_size();</highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classgeo_1_1Transform2T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Transform2</ref><sp/>pose;</highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/>pose.<ref refid="classgeo_1_1Transform2T_1aed7a26b999f43c9186efe8991823bf13" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">t</ref><sp/>=<sp/><ref refid="classLocalizationPlugin_1a5a29ff433d2b52caa7bd7108179d30b6" kindref="member">min_map_</ref>;</highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classgeo_1_1Vec2T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Vec2</ref><sp/>map_size<sp/>=<sp/><ref refid="classLocalizationPlugin_1ac0110dc06034e301bd2ee326aa914568" kindref="member">max_map_</ref><sp/>-<sp/><ref refid="classLocalizationPlugin_1a5a29ff433d2b52caa7bd7108179d30b6" kindref="member">min_map_</ref>;</highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/>pose.<ref refid="classgeo_1_1Transform2T_1aed7a26b999f43c9186efe8991823bf13" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">t</ref>.<ref refid="classgeo_1_1Vec2T_1a476c2f7cacbf6b233746ab18f2a87c54" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">x</ref><sp/>+=<sp/><sp/>drand48()<sp/>*<sp/>map_size.<ref refid="classgeo_1_1Vec2T_1a476c2f7cacbf6b233746ab18f2a87c54" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">x</ref>;</highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/><sp/><sp/>pose.<ref refid="classgeo_1_1Transform2T_1aed7a26b999f43c9186efe8991823bf13" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">t</ref>.<ref refid="classgeo_1_1Vec2T_1a506e3148ad901feea9e7658a4d35fe8b" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">y</ref><sp/>+=<sp/><sp/>drand48()<sp/>*<sp/>map_size.<ref refid="classgeo_1_1Vec2T_1a506e3148ad901feea9e7658a4d35fe8b" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">y</ref>;</highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/>pose.<ref refid="classgeo_1_1Transform2T_1aa36300150db55b0e8032e3e86ab549b7" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">setRotation</ref>(drand48()<sp/>*<sp/>2<sp/>*<sp/>M_PI<sp/>-<sp/>M_PI);</highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pose;</highlight></codeline>
<codeline lineno="571"><highlight class="normal">}</highlight></codeline>
<codeline lineno="572"><highlight class="normal"></highlight></codeline>
<codeline lineno="573"><highlight class="normal"></highlight><highlight class="comment">//<sp/>----------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="574"><highlight class="normal"></highlight></codeline>
<codeline lineno="575" refid="classLocalizationPlugin_1ad53bf0ce4d03282a57b6948cffffcb54" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classLocalizationPlugin_1ad53bf0ce4d03282a57b6948cffffcb54" kindref="member">LocalizationPlugin::updateMapSize</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classed_1_1WorldModel_1_1EntityIterator" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/ed/tags">ed::WorldModel</ref>&amp;<sp/>world)</highlight></codeline>
<codeline lineno="576"><highlight class="normal">{</highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(world.<ref refid="classed_1_1WorldModel_1af7e4da61e1b3ebeaf6a22ed429fac4af" kindref="member" external="/home/docker/ros/noetic/system/build/docs/ed/tags">revision</ref>()<sp/>&lt;=<sp/><ref refid="classLocalizationPlugin_1a9c03f4191cdb8753e1c5dddb76abb53a" kindref="member">last_map_size_revision_</ref>)</highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="579"><highlight class="normal"></highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classgeo_1_1Vec2T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Vec2</ref><sp/>min(1e6,<sp/>1e6),<sp/>max(-1e6,<sp/>-1e6);</highlight></codeline>
<codeline lineno="581"><highlight class="normal"></highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>it<sp/>=<sp/>world.<ref refid="classed_1_1WorldModel_1a45e713418836a435e87a9bf581ff3652" kindref="member" external="/home/docker/ros/noetic/system/build/docs/ed/tags">begin</ref>();<sp/>it<sp/>!=<sp/>world.<ref refid="classed_1_1WorldModel_1aceb56d45eb166688119adc58b1756b6c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/ed/tags">end</ref>();<sp/>++<sp/>it)</highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceed_1ac65887f1813a584fb493e0a93b80d277" kindref="member" external="/home/docker/ros/noetic/system/build/docs/ed/tags">ed::EntityConstPtr</ref>&amp;<sp/>e<sp/>=<sp/>*it;</highlight></codeline>
<codeline lineno="585"><highlight class="normal"></highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="cpp/memory/shared_ptr" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">geo::ShapeConstPtr</ref>&amp;<sp/>shape<sp/>=<sp/>e-&gt;visual();</highlight></codeline>
<codeline lineno="587"><highlight class="normal"></highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Skip<sp/>robot<sp/>and<sp/>entities<sp/>without<sp/>pose<sp/>or<sp/>shape</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!e-&gt;has_pose()<sp/>||<sp/>!shape<sp/>||<sp/>e-&gt;hasFlag(</highlight><highlight class="stringliteral">&quot;self&quot;</highlight><highlight class="normal">)<sp/>||<sp/>shape-&gt;getBoundingBox().getMax().z<sp/>&lt;<sp/>0.05)</highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="591"><highlight class="normal"></highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classgeo_1_1Vector3" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Vector3</ref><sp/>min_entity_world<sp/>=<sp/>e-&gt;pose()<sp/>*<sp/>shape-&gt;getBoundingBox().getMin();</highlight></codeline>
<codeline lineno="593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classgeo_1_1Vector3" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Vector3</ref><sp/>max_entity_world<sp/>=<sp/>e-&gt;pose()<sp/>*<sp/>shape-&gt;getBoundingBox().getMax();</highlight></codeline>
<codeline lineno="594"><highlight class="normal"></highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>min.x<sp/>=<sp/>std::min&lt;double&gt;(min.x,<sp/>min_entity_world.<ref refid="classgeo_1_1Vector3_1a76c1080f7771ddba6188926a9a1f129c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">x</ref>);</highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>min.y<sp/>=<sp/>std::min&lt;double&gt;(min.y,<sp/>min_entity_world.<ref refid="classgeo_1_1Vector3_1aaf3667dc32f8d47f4c688c31a4f6cc7b" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">y</ref>);</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>max.x<sp/>=<sp/>std::max&lt;double&gt;(max.x,<sp/>max_entity_world.<ref refid="classgeo_1_1Vector3_1a76c1080f7771ddba6188926a9a1f129c" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">x</ref>);</highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>max.y<sp/>=<sp/>std::max&lt;double&gt;(max.y,<sp/>max_entity_world.<ref refid="classgeo_1_1Vector3_1aaf3667dc32f8d47f4c688c31a4f6cc7b" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">y</ref>);</highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="600"><highlight class="normal"></highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1a5a29ff433d2b52caa7bd7108179d30b6" kindref="member">min_map_</ref><sp/>=<sp/>min;</highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1ac0110dc06034e301bd2ee326aa914568" kindref="member">max_map_</ref><sp/>=<sp/>max;</highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1a9c03f4191cdb8753e1c5dddb76abb53a" kindref="member">last_map_size_revision_</ref><sp/>=<sp/>world.<ref refid="classed_1_1WorldModel_1af7e4da61e1b3ebeaf6a22ed429fac4af" kindref="member" external="/home/docker/ros/noetic/system/build/docs/ed/tags">revision</ref>();</highlight></codeline>
<codeline lineno="604"><highlight class="normal"></highlight></codeline>
<codeline lineno="605"><highlight class="normal">}</highlight></codeline>
<codeline lineno="606"><highlight class="normal"></highlight></codeline>
<codeline lineno="607"><highlight class="normal"></highlight><highlight class="comment">//<sp/>----------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="608"><highlight class="normal"></highlight></codeline>
<codeline lineno="609" refid="classLocalizationPlugin_1aab85299fc7e0f8430a4778a75d55c2e5" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classLocalizationPlugin_1aab85299fc7e0f8430a4778a75d55c2e5" kindref="member">LocalizationPlugin::visualize</ref>()</highlight></codeline>
<codeline lineno="610"><highlight class="normal">{</highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/>ROS_DEBUG_NAMED(</highlight><highlight class="stringliteral">&quot;Localization&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Visualize&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>grid_size<sp/>=<sp/>800;</highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>grid_resolution<sp/>=<sp/>0.025;</highlight></codeline>
<codeline lineno="614"><highlight class="normal"></highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/>cv::Mat<sp/><ref refid="record__to__video_8cpp_1a666c70a25e5ec1223dee12c73c1ea2cc" kindref="member" external="/home/docker/ros/noetic/system/build/docs/rgbd/tags">rgb_image</ref>(grid_size,<sp/>grid_size,<sp/>CV_8UC3,<sp/>cv::Scalar(10,<sp/>10,<sp/>10));</highlight></codeline>
<codeline lineno="616"><highlight class="normal"></highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="cpp/container/vector" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">std::vector&lt;geo::Vector3&gt;</ref><sp/>sensor_points;</highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classLocalizationPlugin_1aba89e1770526c9705f2f8f07c25118dc" kindref="member">laser_model_</ref>.<ref refid="classLaserModel_1a01ecfd72a7ca4fbc35a20f115e0ec80d" kindref="member">renderer</ref>().<ref refid="classgeo_1_1LaserRangeFinder_1a09583367efcdd8998f9b6d347e1d40e5" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">rangesToPoints</ref>(<ref refid="classLocalizationPlugin_1aba89e1770526c9705f2f8f07c25118dc" kindref="member">laser_model_</ref>.<ref refid="classLaserModel_1a7d37b9022fd77fce0f9a36e4db94c04e" kindref="member">sensor_ranges</ref>(),<sp/>sensor_points);</highlight></codeline>
<codeline lineno="619"><highlight class="normal"></highlight></codeline>
<codeline lineno="620"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classgeo_1_1Transform2T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Transform2</ref><sp/>best_pose<sp/>=<sp/>(<ref refid="classLocalizationPlugin_1a33ba6850e565de9231fea1704fa36cec" kindref="member">latest_map_odom_</ref><sp/>*<sp/><ref refid="classLocalizationPlugin_1a66273bd3858e4e623cbafa97ac173aba" kindref="member">previous_odom_pose_</ref>).projectTo2d();</highlight></codeline>
<codeline lineno="621"><highlight class="normal"></highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classgeo_1_1Transform2T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Transform2</ref><sp/>laser_pose<sp/>=<sp/>best_pose<sp/>*<sp/><ref refid="classLocalizationPlugin_1aba89e1770526c9705f2f8f07c25118dc" kindref="member">laser_model_</ref>.<ref refid="classLaserModel_1ae959fa5bbd285298204a1e3f1ba7d761" kindref="member">laser_offset</ref>();</highlight></codeline>
<codeline lineno="623"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>sensor_points.<ref refid="cpp/container/vector/size" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">size</ref>();<sp/>++i)</highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classgeo_1_1Vec2T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Vec2</ref>&amp;<sp/>p<sp/>=<sp/>laser_pose<sp/>*<sp/><ref refid="namespacegeo_1a721c6e5b9502c5b4337a1c0b61668362" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Vec2</ref>(sensor_points[i].x,<sp/>sensor_points[i].y);</highlight></codeline>
<codeline lineno="626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>mx<sp/>=<sp/>-(p.<ref refid="classgeo_1_1Vec2T_1a506e3148ad901feea9e7658a4d35fe8b" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">y</ref><sp/>-<sp/>best_pose.<ref refid="classgeo_1_1Transform2T_1aed7a26b999f43c9186efe8991823bf13" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">t</ref>.<ref refid="classgeo_1_1Vec2T_1a506e3148ad901feea9e7658a4d35fe8b" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">y</ref>)<sp/>/<sp/>grid_resolution<sp/>+<sp/>grid_size<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>my<sp/>=<sp/>-(p.<ref refid="classgeo_1_1Vec2T_1a476c2f7cacbf6b233746ab18f2a87c54" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">x</ref><sp/>-<sp/>best_pose.<ref refid="classgeo_1_1Transform2T_1aed7a26b999f43c9186efe8991823bf13" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">t</ref>.<ref refid="classgeo_1_1Vec2T_1a476c2f7cacbf6b233746ab18f2a87c54" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">x</ref>)<sp/>/<sp/>grid_resolution<sp/>+<sp/>grid_size<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="628"><highlight class="normal"></highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(mx<sp/>&gt;=<sp/>0<sp/>&amp;&amp;<sp/>my<sp/>&gt;=<sp/>0<sp/>&amp;&amp;<sp/>mx<sp/>&lt;<sp/>grid_size<sp/>&amp;&amp;<sp/>my<sp/>&lt;grid_size)</highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="record__to__video_8cpp_1a666c70a25e5ec1223dee12c73c1ea2cc" kindref="member" external="/home/docker/ros/noetic/system/build/docs/rgbd/tags">rgb_image</ref>.at&lt;cv::Vec3b&gt;(my,<sp/>mx)<sp/>=<sp/>cv::Vec3b(0,<sp/>255,<sp/>0);</highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="634"><highlight class="normal"></highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="cpp/container/vector" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">std::vector&lt;geo::Vec2&gt;</ref>&amp;<sp/>lines_start<sp/>=<sp/><ref refid="classLocalizationPlugin_1aba89e1770526c9705f2f8f07c25118dc" kindref="member">laser_model_</ref>.<ref refid="classLaserModel_1a48bbed136c9877bd247c83d46ee74a06" kindref="member">lines_start</ref>();</highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="cpp/container/vector" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">std::vector&lt;geo::Vec2&gt;</ref>&amp;<sp/>lines_end<sp/>=<sp/><ref refid="classLocalizationPlugin_1aba89e1770526c9705f2f8f07c25118dc" kindref="member">laser_model_</ref>.<ref refid="classLaserModel_1ad2f19e683837ebc75ad44fa8abe9b4f3" kindref="member">lines_end</ref>();</highlight></codeline>
<codeline lineno="637"><highlight class="normal"></highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>lines_start.<ref refid="cpp/container/vector/size" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">size</ref>();<sp/>++i)</highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classgeo_1_1Vec2T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Vec2</ref>&amp;<sp/>p1<sp/>=<sp/>lines_start[i];</highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>mx1<sp/>=<sp/>-(p1.<ref refid="classgeo_1_1Vec2T_1a506e3148ad901feea9e7658a4d35fe8b" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">y</ref><sp/>-<sp/>best_pose.<ref refid="classgeo_1_1Transform2T_1aed7a26b999f43c9186efe8991823bf13" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">t</ref>.<ref refid="classgeo_1_1Vec2T_1a506e3148ad901feea9e7658a4d35fe8b" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">y</ref>)<sp/>/<sp/>grid_resolution<sp/>+<sp/>grid_size<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>my1<sp/>=<sp/>-(p1.<ref refid="classgeo_1_1Vec2T_1a476c2f7cacbf6b233746ab18f2a87c54" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">x</ref><sp/>-<sp/>best_pose.<ref refid="classgeo_1_1Transform2T_1aed7a26b999f43c9186efe8991823bf13" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">t</ref>.<ref refid="classgeo_1_1Vec2T_1a476c2f7cacbf6b233746ab18f2a87c54" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">x</ref>)<sp/>/<sp/>grid_resolution<sp/>+<sp/>grid_size<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="643"><highlight class="normal"></highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classgeo_1_1Vec2T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Vec2</ref>&amp;<sp/>p2<sp/>=<sp/>lines_end[i];</highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>mx2<sp/>=<sp/>-(p2.<ref refid="classgeo_1_1Vec2T_1a506e3148ad901feea9e7658a4d35fe8b" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">y</ref><sp/>-<sp/>best_pose.<ref refid="classgeo_1_1Transform2T_1aed7a26b999f43c9186efe8991823bf13" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">t</ref>.<ref refid="classgeo_1_1Vec2T_1a506e3148ad901feea9e7658a4d35fe8b" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">y</ref>)<sp/>/<sp/>grid_resolution<sp/>+<sp/>grid_size<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>my2<sp/>=<sp/>-(p2.<ref refid="classgeo_1_1Vec2T_1a476c2f7cacbf6b233746ab18f2a87c54" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">x</ref><sp/>-<sp/>best_pose.<ref refid="classgeo_1_1Transform2T_1aed7a26b999f43c9186efe8991823bf13" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">t</ref>.<ref refid="classgeo_1_1Vec2T_1a476c2f7cacbf6b233746ab18f2a87c54" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">x</ref>)<sp/>/<sp/>grid_resolution<sp/>+<sp/>grid_size<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="647"><highlight class="normal"></highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cv::line(<ref refid="record__to__video_8cpp_1a666c70a25e5ec1223dee12c73c1ea2cc" kindref="member" external="/home/docker/ros/noetic/system/build/docs/rgbd/tags">rgb_image</ref>,<sp/>cv::Point(mx1,<sp/>my1),<sp/>cv::Point(mx2,<sp/>my2),<sp/>cv::Scalar(255,<sp/>255,<sp/>255),<sp/>1);</highlight></codeline>
<codeline lineno="649"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="650"><highlight class="normal"></highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="cpp/container/vector" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">std::vector&lt;Sample&gt;</ref>&amp;<sp/>samples<sp/>=<sp/><ref refid="classLocalizationPlugin_1a36cfa1be4e485cc98a50bb8df493f9af" kindref="member">particle_filter_</ref>.<ref refid="classParticleFilter_1a8be684d1455f22a4a46149a222ccec8e" kindref="member">samples</ref>();</highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(<ref refid="cpp/container/vector" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">std::vector&lt;Sample&gt;::const_iterator</ref><sp/>it<sp/>=<sp/>samples.<ref refid="cpp/container/vector/begin" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">begin</ref>();<sp/>it<sp/>!=<sp/>samples.<ref refid="cpp/container/vector/end" kindref="compound" external="/home/docker/.local/lib/python3.8/site-packages/catkin_tools_document/external/cppreference-doxygen-web.tag.xml">end</ref>();<sp/>++it)</highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classgeo_1_1Transform2T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Transform2</ref>&amp;<sp/>pose<sp/>=<sp/>it-&gt;pose;</highlight></codeline>
<codeline lineno="655"><highlight class="normal"></highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Visualize<sp/>sensor</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>lmx<sp/>=<sp/>-(pose.<ref refid="classgeo_1_1Transform2T_1aed7a26b999f43c9186efe8991823bf13" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">t</ref>.<ref refid="classgeo_1_1Vec2T_1a506e3148ad901feea9e7658a4d35fe8b" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">y</ref><sp/>-<sp/>best_pose.<ref refid="classgeo_1_1Transform2T_1aed7a26b999f43c9186efe8991823bf13" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">t</ref>.<ref refid="classgeo_1_1Vec2T_1a506e3148ad901feea9e7658a4d35fe8b" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">y</ref>)<sp/>/<sp/>grid_resolution<sp/>+<sp/>grid_size<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>lmy<sp/>=<sp/>-(pose.<ref refid="classgeo_1_1Transform2T_1aed7a26b999f43c9186efe8991823bf13" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">t</ref>.<ref refid="classgeo_1_1Vec2T_1a476c2f7cacbf6b233746ab18f2a87c54" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">x</ref><sp/>-<sp/>best_pose.<ref refid="classgeo_1_1Transform2T_1aed7a26b999f43c9186efe8991823bf13" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">t</ref>.<ref refid="classgeo_1_1Vec2T_1a476c2f7cacbf6b233746ab18f2a87c54" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">x</ref>)<sp/>/<sp/>grid_resolution<sp/>+<sp/>grid_size<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cv::circle(<ref refid="record__to__video_8cpp_1a666c70a25e5ec1223dee12c73c1ea2cc" kindref="member" external="/home/docker/ros/noetic/system/build/docs/rgbd/tags">rgb_image</ref>,<sp/>cv::Point(lmx,lmy),<sp/>0.1<sp/>/<sp/>grid_resolution,<sp/>cv::Scalar(0,<sp/>0,<sp/>255),<sp/>1);</highlight></codeline>
<codeline lineno="660"><highlight class="normal"></highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classgeo_1_1Vec2T" kindref="compound" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Vec2</ref><sp/>d<sp/>=<sp/>pose.<ref refid="classgeo_1_1Transform2T_1ace6ce78db401a84c1dfbe0ec83f4dee5" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">R</ref><sp/>*<sp/><ref refid="namespacegeo_1a721c6e5b9502c5b4337a1c0b61668362" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">geo::Vec2</ref>(0.2,<sp/>0);</highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>dmx<sp/>=<sp/>-d.<ref refid="classgeo_1_1Vec2T_1a506e3148ad901feea9e7658a4d35fe8b" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">y</ref><sp/>/<sp/>grid_resolution;</highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>dmy<sp/>=<sp/>-d.<ref refid="classgeo_1_1Vec2T_1a476c2f7cacbf6b233746ab18f2a87c54" kindref="member" external="/home/docker/ros/noetic/system/build/docs/geolib2/tags">x</ref><sp/>/<sp/>grid_resolution;</highlight></codeline>
<codeline lineno="664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cv::line(<ref refid="record__to__video_8cpp_1a666c70a25e5ec1223dee12c73c1ea2cc" kindref="member" external="/home/docker/ros/noetic/system/build/docs/rgbd/tags">rgb_image</ref>,<sp/>cv::Point(lmx,<sp/>lmy),<sp/>cv::Point(lmx<sp/>+<sp/>dmx,<sp/>lmy<sp/>+<sp/>dmy),<sp/>cv::Scalar(0,<sp/>0,<sp/>255),<sp/>1);</highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="666"><highlight class="normal"></highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/><sp/><sp/>cv::imshow(</highlight><highlight class="stringliteral">&quot;localization&quot;</highlight><highlight class="normal">,<sp/><ref refid="record__to__video_8cpp_1a666c70a25e5ec1223dee12c73c1ea2cc" kindref="member" external="/home/docker/ros/noetic/system/build/docs/rgbd/tags">rgb_image</ref>);</highlight></codeline>
<codeline lineno="668"><highlight class="normal"><sp/><sp/><sp/><sp/>cv::waitKey(1);</highlight></codeline>
<codeline lineno="669"><highlight class="normal">}</highlight></codeline>
<codeline lineno="670"><highlight class="normal"></highlight></codeline>
<codeline lineno="671"><highlight class="normal"></highlight><highlight class="comment">//<sp/>----------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="672"><highlight class="normal"></highlight></codeline>
<codeline lineno="673"><highlight class="normal"><ref refid="plugin_8h_1a9cb7a92c38d28d6074b1b1904d38d545" kindref="member" external="/home/docker/ros/noetic/system/build/docs/ed/tags">ED_REGISTER_PLUGIN</ref>(<ref refid="classLocalizationPlugin" kindref="compound">LocalizationPlugin</ref>)</highlight></codeline>
    </programlisting>
    <location file="src/localization_plugin.cpp"/>
  </compounddef>
</doxygen>
