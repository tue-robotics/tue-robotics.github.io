<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.17">
  <compounddef id="take__orders_8py" kind="file" language="Python">
    <compoundname>take_orders.py</compoundname>
    <innerclass refid="classchallenge__restaurant_1_1take__orders_1_1ClearOrders" prot="public">challenge_restaurant::take_orders::ClearOrders</innerclass>
    <innerclass refid="classchallenge__restaurant_1_1take__orders_1_1ReciteOrders" prot="public">challenge_restaurant::take_orders::ReciteOrders</innerclass>
    <innerclass refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder" prot="public">challenge_restaurant::take_orders::TakeOrder</innerclass>
    <innernamespace refid="namespacechallenge__restaurant_1_1take__orders">challenge_restaurant::take_orders</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1" refid="namespacechallenge__restaurant_1_1take__orders" refkind="compound"><highlight class="comment">#!/usr/bin/python</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>__future__<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>print_function</highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="comment">#<sp/>System</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>random</highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="comment">#<sp/>ROS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>pykdl_ros<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>VectorStamped</highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>rospy</highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>smach</highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="comment">#<sp/>TU/e<sp/>Robotics</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>ed.entity<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Entity</highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>hmi<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>TimeoutException</highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>robot_skills.simulation.sim_mode<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>is_sim_mode</highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>robocup_knowledge<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>knowledge_loader</highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>robot_smach_states.util.designators<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>ds</highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Knowledge</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21" refid="namespacechallenge__restaurant_1_1take__orders_1af600b7dc27b14d7497bf784a10dd60fb" refkind="member"><highlight class="normal">knowledge<sp/>=<sp/>knowledge_loader.load_knowledge(</highlight><highlight class="stringliteral">&quot;challenge_restaurant&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight></codeline>
<codeline lineno="24" refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder" kindref="compound">TakeOrder</ref>(smach.State):</highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>Take<sp/>an<sp/>order<sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight></codeline>
<codeline lineno="27" refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1a6ffee8e3e32878881a5f18f4a5843a51" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1a6ffee8e3e32878881a5f18f4a5843a51" kindref="member">__init__</ref>(self,<sp/>robot,<sp/>entity_designator,<sp/>orders):</highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>Constructor</highlight></codeline>
<codeline lineno="29"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="30"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>robot:<sp/>robot<sp/>object</highlight></codeline>
<codeline lineno="31"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>orders:<sp/>Python<sp/>dict<sp/>in<sp/>which<sp/>the<sp/>orders<sp/>will<sp/>be<sp/>stored</highlight></codeline>
<codeline lineno="32"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:return:<sp/>Result<sp/>of<sp/>taking<sp/>orders:</highlight></codeline>
<codeline lineno="33"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>succeeded:<sp/>understood<sp/>correctly</highlight></codeline>
<codeline lineno="34"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>failed:<sp/>didn&apos;t<sp/>hear<sp/>anything<sp/>or<sp/>exceeded<sp/>maximum<sp/>number<sp/>of<sp/>tries</highlight></codeline>
<codeline lineno="35"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>misunderstood:<sp/>misunderstood,<sp/>might<sp/>try<sp/>again</highlight></codeline>
<codeline lineno="36"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>smach.State.__init__(self,<sp/>outcomes=[</highlight><highlight class="stringliteral">&apos;succeeded&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;failed&apos;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight></codeline>
<codeline lineno="39" refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1ae351c1dd9e872f7e1fc97ec874decc1d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1ae351c1dd9e872f7e1fc97ec874decc1d" kindref="member">_robot</ref><sp/>=<sp/>robot</highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ds.check_type(entity_designator,<sp/>Entity)</highlight></codeline>
<codeline lineno="41" refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1a59f191fc1fc74a51f28f3056d2cc1180" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1a59f191fc1fc74a51f28f3056d2cc1180" kindref="member">_entity_designator</ref><sp/>=<sp/>entity_designator</highlight></codeline>
<codeline lineno="42" refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1a973d90883882dad9d17c5e9f946ca56d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1a973d90883882dad9d17c5e9f946ca56d" kindref="member">_orders</ref><sp/>=<sp/>orders</highlight></codeline>
<codeline lineno="43" refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1a8b01dffab413cdec6223a4c8460a244f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1a8b01dffab413cdec6223a4c8460a244f" kindref="member">number_of_tries</ref><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="44" refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1ad46bebe141df326f1e4be2532a337809" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1ad46bebe141df326f1e4be2532a337809" kindref="member">_max_tries</ref><sp/>=<sp/>2</highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight></codeline>
<codeline lineno="46" refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1aff0bc06ca6a3cac70755174430d25803" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1aff0bc06ca6a3cac70755174430d25803" kindref="member">_confirm</ref>(self):</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>speech_result<sp/>=<sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1ae351c1dd9e872f7e1fc97ec874decc1d" kindref="member">_robot</ref>.hmi.query(description=</highlight><highlight class="stringliteral">&quot;Is<sp/>this<sp/>correct?&quot;</highlight><highlight class="normal">,<sp/>grammar=</highlight><highlight class="stringliteral">&quot;T[True]<sp/>-&gt;<sp/>yes;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;T[False]<sp/>-&gt;<sp/>no&quot;</highlight><highlight class="normal">,<sp/>target=</highlight><highlight class="stringliteral">&quot;T&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>TimeoutException:</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>speech_result.semantics</highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight></codeline>
<codeline lineno="56" refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1a94b039507391d157be581b4dd17f73ec" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1a94b039507391d157be581b4dd17f73ec" kindref="member">_confirm_picovoice</ref>(self):</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>speech_result<sp/>=<sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1ae351c1dd9e872f7e1fc97ec874decc1d" kindref="member">_robot</ref>.picovoice.get_intent(context_url=</highlight><highlight class="stringliteral">&quot;yesOrNo&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>TimeoutException:</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;yes&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>speech_result.semantics</highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight></codeline>
<codeline lineno="64" refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1ab5ae71f6e590ac4e89c807f86988e91d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1ab5ae71f6e590ac4e89c807f86988e91d" kindref="member">execute</ref>(self,<sp/>userdata=None):</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>person<sp/>=<sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1a59f191fc1fc74a51f28f3056d2cc1180" kindref="member">_entity_designator</ref>.resolve()</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>person:</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1ae351c1dd9e872f7e1fc97ec874decc1d" kindref="member">_robot</ref>.head.look_at_point(VectorStamped.from_framestamped(person.pose),<sp/>timeout=0.0)</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rospy.logwarn(</highlight><highlight class="stringliteral">&quot;Could<sp/>not<sp/>resolve<sp/>person,<sp/>looking<sp/>down<sp/>..&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1ae351c1dd9e872f7e1fc97ec874decc1d" kindref="member">_robot</ref>.head.look_at_ground_in_front_of_robot(3)</highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1ae351c1dd9e872f7e1fc97ec874decc1d" kindref="member">_robot</ref>.head.wait_for_motion_done()</highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nr_tries<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>nr_tries<sp/>&lt;<sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1ad46bebe141df326f1e4be2532a337809" kindref="member">_max_tries</ref><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>rospy.is_shutdown():</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nr_tries<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rospy.loginfo(</highlight><highlight class="stringliteral">&apos;nr_tries:<sp/>%d&apos;</highlight><highlight class="normal">,<sp/>nr_tries)</highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1ae351c1dd9e872f7e1fc97ec874decc1d" kindref="member">_robot</ref>.speech.speak(</highlight><highlight class="stringliteral">&quot;What<sp/>would<sp/>you<sp/>like<sp/>to<sp/>order?&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1ae351c1dd9e872f7e1fc97ec874decc1d" kindref="member">_robot</ref>.speech.speak(</highlight><highlight class="stringliteral">&quot;Please<sp/>speak<sp/>fast<sp/>without<sp/>breaks.&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>count<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>rospy.is_shutdown():</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>count<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="84"><highlight class="normal"></highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>is_sim_mode():</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>speech_result<sp/>=<sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1ae351c1dd9e872f7e1fc97ec874decc1d" kindref="member">_robot</ref>.hmi.query(description=</highlight><highlight class="stringliteral">&quot;Can<sp/>I<sp/>please<sp/>take<sp/>your<sp/>order&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grammar=knowledge.order_grammar,<sp/>target=</highlight><highlight class="stringliteral">&quot;O&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>speech_result<sp/>=<sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1ae351c1dd9e872f7e1fc97ec874decc1d" kindref="member">_robot</ref>.picovoice.get_intent(context_url=</highlight><highlight class="stringliteral">&quot;restaurant&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>TimeoutException:</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>count<sp/>&lt;<sp/>3:</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1ae351c1dd9e872f7e1fc97ec874decc1d" kindref="member">_robot</ref>.speech.speak(</highlight><highlight class="stringliteral">&quot;Please<sp/>speak<sp/>even<sp/>louder<sp/>and<sp/>directly<sp/>into<sp/>my<sp/>microphone&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1ae351c1dd9e872f7e1fc97ec874decc1d" kindref="member">_robot</ref>.speech.speak(</highlight><highlight class="stringliteral">&quot;I<sp/>am<sp/>sorry<sp/>but<sp/>I<sp/>cannot<sp/>understand<sp/>you.<sp/>I<sp/>will<sp/>quit<sp/>now&quot;</highlight><highlight class="normal">,<sp/>block=</highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1ae351c1dd9e872f7e1fc97ec874decc1d" kindref="member">_robot</ref>.head.cancel_goal()</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;failed&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="99"><highlight class="normal"></highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>order_string<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;<sp/>and<sp/>a<sp/>&quot;</highlight><highlight class="normal">.join(speech_result.semantics.values())</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1ae351c1dd9e872f7e1fc97ec874decc1d" kindref="member">_robot</ref>.speech.speak(</highlight><highlight class="stringliteral">&quot;I<sp/>understood<sp/>that<sp/>you<sp/>would<sp/>like<sp/>a<sp/>{},<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;is<sp/>this<sp/>correct?&quot;</highlight><highlight class="normal">.format(order_string),<sp/>block=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(is_sim_mode()<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1aff0bc06ca6a3cac70755174430d25803" kindref="member">_confirm</ref>())<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>is_sim_mode()<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1a94b039507391d157be581b4dd17f73ec" kindref="member">_confirm_picovoice</ref>()):</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>DO<sp/>NOT<sp/>ASSIGN<sp/>self._orders<sp/>OR<sp/>OTHER<sp/>STATES<sp/>WILL<sp/>NOT<sp/>HAVE<sp/>THE<sp/>CORRECT<sp/>REFERENCE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>item<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>speech_result.semantics.values():</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1a973d90883882dad9d17c5e9f946ca56d" kindref="member">_orders</ref>.append(item)</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1ae351c1dd9e872f7e1fc97ec874decc1d" kindref="member">_robot</ref>.head.cancel_goal()</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1ae351c1dd9e872f7e1fc97ec874decc1d" kindref="member">_robot</ref>.speech.speak(</highlight><highlight class="stringliteral">&quot;Ok,<sp/>I<sp/>will<sp/>get<sp/>your<sp/>order&quot;</highlight><highlight class="normal">,<sp/>block=</highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;succeeded&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"></highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1ae351c1dd9e872f7e1fc97ec874decc1d" kindref="member">_robot</ref>.speech.speak(</highlight><highlight class="stringliteral">&quot;I<sp/>am<sp/>sorry<sp/>but<sp/>I<sp/>cannot<sp/>understand<sp/>you.<sp/>I<sp/>will<sp/>quit<sp/>now&quot;</highlight><highlight class="normal">,<sp/>block=</highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder_1ae351c1dd9e872f7e1fc97ec874decc1d" kindref="member">_robot</ref>.head.cancel_goal()</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;failed&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="118"><highlight class="normal"></highlight></codeline>
<codeline lineno="119"><highlight class="normal"></highlight></codeline>
<codeline lineno="120" refid="classchallenge__restaurant_1_1take__orders_1_1ReciteOrders" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classchallenge__restaurant_1_1take__orders_1_1ReciteOrders" kindref="compound">ReciteOrders</ref>(smach.State):</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>Recites<sp/>the<sp/>received<sp/>order<sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight></codeline>
<codeline lineno="123" refid="classchallenge__restaurant_1_1take__orders_1_1ReciteOrders_1ad35a0f2c338a390329799bf2decebda4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classchallenge__restaurant_1_1take__orders_1_1ReciteOrders_1ad35a0f2c338a390329799bf2decebda4" kindref="member">__init__</ref>(self,<sp/>robot,<sp/>orders):</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>Constructor</highlight></codeline>
<codeline lineno="125"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="126"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>robot:<sp/>robot<sp/>object</highlight></codeline>
<codeline lineno="127"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>orders:<sp/>Python<sp/>dict<sp/>with<sp/>orders</highlight></codeline>
<codeline lineno="128"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>smach.State.__init__(self,<sp/>outcomes=[</highlight><highlight class="stringliteral">&quot;spoken&quot;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="130"><highlight class="normal"></highlight></codeline>
<codeline lineno="131" refid="classchallenge__restaurant_1_1take__orders_1_1ReciteOrders_1a9008ad497a24c544a937669dc3158646" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1ReciteOrders_1a9008ad497a24c544a937669dc3158646" kindref="member">_robot</ref><sp/>=<sp/>robot</highlight></codeline>
<codeline lineno="132" refid="classchallenge__restaurant_1_1take__orders_1_1ReciteOrders_1a7879d1e6660e113d5c6bec5934d3c6d0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1ReciteOrders_1a7879d1e6660e113d5c6bec5934d3c6d0" kindref="member">_orders</ref><sp/>=<sp/>orders</highlight></codeline>
<codeline lineno="133"><highlight class="normal"></highlight></codeline>
<codeline lineno="134" refid="classchallenge__restaurant_1_1take__orders_1_1ReciteOrders_1a8ad8c4c07f9d2501e7a2c3fe4cce7042" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classchallenge__restaurant_1_1take__orders_1_1ReciteOrders_1a8ad8c4c07f9d2501e7a2c3fe4cce7042" kindref="member">execute</ref>(self,<sp/>userdata=None):</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1ReciteOrders_1a9008ad497a24c544a937669dc3158646" kindref="member">_robot</ref>.head.look_up()</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1ReciteOrders_1a9008ad497a24c544a937669dc3158646" kindref="member">_robot</ref>.speech.speak(</highlight><highlight class="stringliteral">&quot;Mr.<sp/>Barman<sp/>I<sp/>have<sp/>some<sp/>orders.&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="137"><highlight class="normal"></highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>order_string<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;<sp/>and<sp/>a<sp/>&quot;</highlight><highlight class="normal">.join(self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1ReciteOrders_1a7879d1e6660e113d5c6bec5934d3c6d0" kindref="member">_orders</ref>)</highlight></codeline>
<codeline lineno="139"><highlight class="normal"></highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sentence<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Table<sp/>1<sp/>would<sp/>like<sp/>to<sp/>have<sp/>a<sp/>{}&quot;</highlight><highlight class="normal">.format(order_string)</highlight></codeline>
<codeline lineno="141"><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>if<sp/>&quot;beverage&quot;<sp/>in<sp/>self._orders:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>sentence<sp/>=<sp/>&quot;Table<sp/>1<sp/>would<sp/>like<sp/>to<sp/>have<sp/>{}&quot;.format(self._orders[&quot;beverage&quot;])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>if<sp/>&quot;food1&quot;<sp/>in<sp/>self._orders:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>sentence<sp/>=<sp/>&quot;Table<sp/>1<sp/>wants<sp/>the<sp/>combo<sp/>{}<sp/>and<sp/>{}&quot;.format(self._orders[&quot;food1&quot;],</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self._orders[&quot;food2&quot;])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="147"><highlight class="normal"></highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1ReciteOrders_1a9008ad497a24c544a937669dc3158646" kindref="member">_robot</ref>.speech.speak(sentence,<sp/>block=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rospy.sleep(5)</highlight></codeline>
<codeline lineno="150"><highlight class="normal"></highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;red_wine&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1ReciteOrders_1a7879d1e6660e113d5c6bec5934d3c6d0" kindref="member">_orders</ref><sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;red<sp/>wine&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1ReciteOrders_1a7879d1e6660e113d5c6bec5934d3c6d0" kindref="member">_orders</ref><sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;orange_juice&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1ReciteOrders_1a7879d1e6660e113d5c6bec5934d3c6d0" kindref="member">_orders</ref><sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;orange<sp/>juice&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1ReciteOrders_1a7879d1e6660e113d5c6bec5934d3c6d0" kindref="member">_orders</ref>:</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>water_sentence<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;I<sp/>am<sp/>too<sp/>weak<sp/>to<sp/>carry<sp/>the<sp/>red<sp/>wine<sp/>or<sp/>orange<sp/>juicy,<sp/>please<sp/>bring<sp/>that<sp/>yourself.<sp/>And<sp/>please<sp/>make<sp/>me<sp/>stronger.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1ReciteOrders_1a9008ad497a24c544a937669dc3158646" kindref="member">_robot</ref>.speech.speak(water_sentence)</highlight></codeline>
<codeline lineno="154"><highlight class="normal"></highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1ReciteOrders_1a9008ad497a24c544a937669dc3158646" kindref="member">_robot</ref>.head.cancel_goal()</highlight></codeline>
<codeline lineno="156"><highlight class="normal"></highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;spoken&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal"></highlight></codeline>
<codeline lineno="159"><highlight class="normal"></highlight></codeline>
<codeline lineno="160" refid="classchallenge__restaurant_1_1take__orders_1_1ClearOrders" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classchallenge__restaurant_1_1take__orders_1_1ClearOrders" kindref="compound">ClearOrders</ref>(smach.State):</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>Clears<sp/>the<sp/>orders<sp/>dict&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"></highlight></codeline>
<codeline lineno="163" refid="classchallenge__restaurant_1_1take__orders_1_1ClearOrders_1ad7d302faf2193723d0c589853dc264f6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classchallenge__restaurant_1_1take__orders_1_1ClearOrders_1ad7d302faf2193723d0c589853dc264f6" kindref="member">__init__</ref>(self,<sp/>orders):</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>Constructor</highlight></codeline>
<codeline lineno="165"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="166"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>orders:<sp/>Python<sp/>dict<sp/>with<sp/>orders</highlight></codeline>
<codeline lineno="167"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>smach.State.__init__(self,<sp/>outcomes=[</highlight><highlight class="stringliteral">&quot;succeeded&quot;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="169"><highlight class="normal"></highlight></codeline>
<codeline lineno="170" refid="classchallenge__restaurant_1_1take__orders_1_1ClearOrders_1ac227f350ce64af1f19235161ae279ee4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1ClearOrders_1ac227f350ce64af1f19235161ae279ee4" kindref="member">orders</ref><sp/>=<sp/>orders</highlight></codeline>
<codeline lineno="171"><highlight class="normal"></highlight></codeline>
<codeline lineno="172" refid="classchallenge__restaurant_1_1take__orders_1_1ClearOrders_1a103eddc0b506c221da854bf0c993e2c5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classchallenge__restaurant_1_1take__orders_1_1ClearOrders_1a103eddc0b506c221da854bf0c993e2c5" kindref="member">execute</ref>(self,<sp/>userdata=None):</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1ClearOrders_1ac227f350ce64af1f19235161ae279ee4" kindref="member">orders</ref>:</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchallenge__restaurant_1_1take__orders_1_1ClearOrders_1ac227f350ce64af1f19235161ae279ee4" kindref="member">orders</ref>.pop()</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;succeeded&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>__name__<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;__main__&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>sys</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>robot_skills<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>get_robot</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>geometry_msgs.msg<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Pose</highlight></codeline>
<codeline lineno="182"><highlight class="normal"></highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(sys.argv)<sp/>&lt;<sp/>2:</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;Please<sp/>provide<sp/>robot<sp/>name<sp/>as<sp/>argument.&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sys.exit(1)</highlight></codeline>
<codeline lineno="186"><highlight class="normal"></highlight></codeline>
<codeline lineno="187" refid="namespacechallenge__restaurant_1_1take__orders_1abafe0a1cb4a5493f22c7598e2e8ee28b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>robot_name<sp/>=<sp/>sys.argv[1]</highlight></codeline>
<codeline lineno="188"><highlight class="normal"></highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/>rospy.init_node(</highlight><highlight class="stringliteral">&apos;test_take_orders&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="190" refid="namespacechallenge__restaurant_1_1take__orders_1a9e970d04a1f218c5f3874943d6915ffa" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>robot<sp/>=<sp/>get_robot(robot_name)</highlight></codeline>
<codeline lineno="191"><highlight class="normal"></highlight></codeline>
<codeline lineno="192" refid="namespacechallenge__restaurant_1_1take__orders_1a935386648b726e0988dec034a9f55be1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>pose<sp/>=<sp/>Pose()</highlight></codeline>
<codeline lineno="193" refid="namespacechallenge__restaurant_1_1take__orders_1a45d682eeafebff9ff2945ae2a6adab4e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>pose.position.x<sp/>=<sp/>1.0</highlight></codeline>
<codeline lineno="194" refid="namespacechallenge__restaurant_1_1take__orders_1a6171e933a7ec6f417834e664b8e7e37c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>pose.position.y<sp/>=<sp/>1.0</highlight></codeline>
<codeline lineno="195" refid="namespacechallenge__restaurant_1_1take__orders_1a58052b5ce25f06cbc1063696116cdd2e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>pose.position.z<sp/>=<sp/>1.6</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/>customer_entity<sp/>=<sp/>Entity(</highlight><highlight class="stringliteral">&apos;random_id&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;person&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;map&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="comment">#<sp/>FrameID<sp/>can<sp/>only<sp/>be<sp/>map<sp/>frame<sp/>unfortunately,<sp/>Our<sp/>KDL<sp/>wrapper<sp/>doesn&apos;t<sp/>do<sp/>well<sp/>with<sp/>PoseStampeds<sp/>etc.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;dummy&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="comment">#<sp/>Only<sp/>pose<sp/>and<sp/>frame_id<sp/>are<sp/>used</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;shape&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;volumes&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;super_types&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;last_update_time&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/>customer_entity.pose<sp/>=<sp/>pose<sp/><sp/></highlight><highlight class="comment">#<sp/>This<sp/>takes<sp/>care<sp/>of<sp/>the<sp/>conversion<sp/>to<sp/>KDL<sp/>for<sp/>us</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/>orders<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/>sm<sp/>=<sp/><ref refid="classchallenge__restaurant_1_1take__orders_1_1TakeOrder" kindref="compound">TakeOrder</ref>(robot,<sp/>ds.Designator(customer_entity),<sp/>orders=orders)</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/>sm.execute()</highlight></codeline>
<codeline lineno="204"><highlight class="normal"></highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/>rospy.loginfo(</highlight><highlight class="stringliteral">&quot;Orders<sp/>{}&quot;</highlight><highlight class="normal">.format(orders))</highlight></codeline>
    </programlisting>
    <location file="src/challenge_restaurant/take_orders.py"/>
  </compounddef>
</doxygen>
