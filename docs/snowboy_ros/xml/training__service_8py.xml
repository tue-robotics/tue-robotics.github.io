<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.17">
  <compounddef id="training__service_8py" kind="file" language="Python">
    <compoundname>training_service.py</compoundname>
    <innernamespace refid="namespacetraining__service">training_service</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1" refid="namespacetraining__service" refkind="compound"><highlight class="comment">#!<sp/>/usr/bin/evn<sp/>python</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>sys</highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>base64</highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>requests</highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight></codeline>
<codeline lineno="8" refid="namespacetraining__service_1af2962e543de61a622dc39c211a847561" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacetraining__service_1af2962e543de61a622dc39c211a847561" kindref="member">get_wave</ref>(fname):</highlight></codeline>
<codeline lineno="9"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">with</highlight><highlight class="normal"><sp/>open(fname)<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>infile:</highlight></codeline>
<codeline lineno="10"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>base64.b64encode(infile.read())</highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight></codeline>
<codeline lineno="13" refid="namespacetraining__service_1ae6891b4582ae45c3c6e564496abe60ef" refkind="member"><highlight class="normal">endpoint<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;https://snowboy.kitt.ai/api/v1/train/&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight></codeline>
<codeline lineno="16" refid="namespacetraining__service_1a859b463bc96dc7e30fbf50bb3cd96a01" refkind="member"><highlight class="normal">token<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17" refid="namespacetraining__service_1a8cbfdb6887f95845e4532e58d3359458" refkind="member"><highlight class="normal">hotword_name<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;???&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18" refid="namespacetraining__service_1a0c407b49948a3ec71aef28fac933f80e" refkind="member"><highlight class="normal">language<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;en&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19" refid="namespacetraining__service_1a319a8a57d02059e663d8267400b9430c" refkind="member"><highlight class="normal">age_group<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;20_29&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20" refid="namespacetraining__service_1adc053127a598cdd08309d88177b6a014" refkind="member"><highlight class="normal">gender<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;M&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21" refid="namespacetraining__service_1a936bfeee1f57d9734cf91fd78fa8d60d" refkind="member"><highlight class="normal">microphone<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;??&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">#<sp/>e.g.,<sp/>macbook<sp/>pro<sp/>microphone</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>__name__<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;__main__&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_,<sp/>wav1,<sp/>wav2,<sp/>wav3,<sp/>out]<sp/>=<sp/>sys.argv</highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>ValueError:</highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">print</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Usage:<sp/>%s<sp/>wave_file1<sp/>wave_file2<sp/>wave_file3<sp/>out_model_name&quot;</highlight><highlight class="normal"><sp/>%<sp/>sys.argv[0]</highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sys.exit()</highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight></codeline>
<codeline lineno="31" refid="namespacetraining__service_1aa2e72dd62a77982b353a0c86ebd14506" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>data<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;name&quot;</highlight><highlight class="normal">:<sp/>hotword_name,</highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;language&quot;</highlight><highlight class="normal">:<sp/>language,</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;age_group&quot;</highlight><highlight class="normal">:<sp/>age_group,</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;gender&quot;</highlight><highlight class="normal">:<sp/>gender,</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;microphone&quot;</highlight><highlight class="normal">:<sp/>microphone,</highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;token&quot;</highlight><highlight class="normal">:<sp/>token,</highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;voice_samples&quot;</highlight><highlight class="normal">:<sp/>[</highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&quot;wave&quot;</highlight><highlight class="normal">:<sp/><ref refid="namespacetraining__service_1af2962e543de61a622dc39c211a847561" kindref="member">get_wave</ref>(wav1)},</highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&quot;wave&quot;</highlight><highlight class="normal">:<sp/><ref refid="namespacetraining__service_1af2962e543de61a622dc39c211a847561" kindref="member">get_wave</ref>(wav2)},</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&quot;wave&quot;</highlight><highlight class="normal">:<sp/><ref refid="namespacetraining__service_1af2962e543de61a622dc39c211a847561" kindref="member">get_wave</ref>(wav3)}</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>]</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight></codeline>
<codeline lineno="45" refid="namespacetraining__service_1a2a00e2ff6d165491b92768a2892aee63" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>response<sp/>=<sp/>requests.post(endpoint,<sp/>json=data)</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>response.ok:</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">with</highlight><highlight class="normal"><sp/>open(out,<sp/></highlight><highlight class="stringliteral">&quot;w&quot;</highlight><highlight class="normal">)<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>outfile:</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outfile.write(response.content)</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">print</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Saved<sp/>model<sp/>to<sp/>&apos;%s&apos;.&quot;</highlight><highlight class="normal"><sp/>%<sp/>out</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">print</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Request<sp/>failed.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">print</highlight><highlight class="normal"><sp/>response.text</highlight></codeline>
    </programlisting>
    <location file="3rdparty/snowboy/examples/REST_API/training_service.py"/>
  </compounddef>
</doxygen>
